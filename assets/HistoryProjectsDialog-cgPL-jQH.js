import{_ as S,b as P}from"./index-mGnb0KKF.js";import{i as z}from"./vuetify-use-dialog-C5oZ13xz.js";import{a as T,r as p,f as V,g as h,c as B,d as H,O as L,F as q,e as N,V as U}from"./vuetify-CbddcmEc.js";import{f as b,r as g,w as $,b2 as F,aV as M,Z as O,bH as l,a8 as o,a0 as s,a7 as n,bf as d}from"./@vue-Cr_z6yfx.js";const Q={class:"card-title px-6 py-4 bg-blue-grey-darken-2 d-flex align-center"},R={class:"px-6 py-6"},W={class:"px-6 pb-4"},Z={class:"d-flex align-center"},E={class:"d-flex align-center"},G={class:"text-center py-8"},J={class:"text-body-1 text-medium-emphasis mt-2"},K={__name:"HistoryProjectsDialog",props:{modelValue:{type:Boolean,default:!1},teamId:{type:String,default:null}},emits:["update:modelValue"],setup(x,{emit:k}){const i=x,C=k,{apiAuth:w}=P(),j=z(),u=b({get:()=>i.modelValue,set:t=>C("update:modelValue",t)}),m=g([]),f=g(!1),r=g(""),I=[{title:"å°ˆæ¡ˆåç¨±",key:"name",sortable:!0},{title:"æ‰€å±¬åœ˜éšŠ",key:"team",sortable:!0},{title:"å®Œæˆæ—¥æœŸ",key:"updatedAt",sortable:!0},{title:"å»ºç«‹æ—¥æœŸ",key:"createdAt",sortable:!0}],A=b(()=>{if(!r.value.trim())return m.value;const t=r.value.toLowerCase().trim();return m.value.filter(e=>e.name.toLowerCase().includes(t))}),y=t=>t?new Date(t).toLocaleDateString("zh-TW"):"-",D=async()=>{try{f.value=!0,console.log("ðŸ” è¼‰å…¥æ­·å²å°ˆæ¡ˆï¼ŒteamId:",i.teamId);const t=new URLSearchParams;i.teamId&&i.teamId!=="null"&&i.teamId!=="undefined"&&t.append("teamId",i.teamId);const e=t.toString()?`/projects/history?${t.toString()}`:"/projects/history";console.log("ðŸ” API ç«¯é»ž:",e);const{data:c}=await w.get(e);c.success&&(m.value=c.data,console.log("ðŸ” è¼‰å…¥çš„æ­·å²å°ˆæ¡ˆæ•¸é‡:",c.data.length))}catch(t){console.error("è¼‰å…¥æ­·å²å°ˆæ¡ˆå¤±æ•—:",t),j({text:"è¼‰å…¥æ­·å²å°ˆæ¡ˆå¤±æ•—",snackbarProps:{color:"red-lighten-1"}})}finally{f.value=!1}},v=()=>{u.value=!1,r.value=""};return $(u,t=>{t&&D()}),(t,e)=>{const c=F("router-link");return M(),O(U,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=a=>u.value=a),persistent:"","max-width":"1200",scrollable:""},{default:l(()=>[o(T,{class:"rounded-lg"},{default:l(()=>[s("div",Q,[o(p,{size:"20",color:"white",class:"me-2"},{default:l(()=>e[3]||(e[3]=[n(" mdi-history ")])),_:1}),e[5]||(e[5]=n(" æ­·å²å°ˆæ¡ˆ ")),o(V),o(h,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:v},{default:l(()=>[o(p,{size:"20"},{default:l(()=>e[4]||(e[4]=[n(" mdi-close ")])),_:1})]),_:1})]),o(B,{class:"pa-0"},{default:l(()=>[s("div",R,[o(H,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),placeholder:"æœå°‹æ­·å²å°ˆæ¡ˆåç¨±...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"search-field","onClick:clear":e[1]||(e[1]=a=>r.value="")},null,8,["modelValue"])]),s("div",W,[o(L,{headers:I,items:A.value,loading:f.value,hover:"",density:"compact","item-key":"_id","items-per-page":25,"items-per-page-options":[10,25,50,100,-1],class:"history-projects-table"},{item:l(({item:a})=>[s("tr",null,[s("td",null,[s("div",Z,[o(p,{icon:a.iconColor&&a.iconColor!=="white"?"mdi-square-rounded":"mdi-square-rounded-outline",class:"me-2",color:a.iconColor&&a.iconColor!=="white"?a.iconColor:"grey"},null,8,["icon","color"]),o(c,{to:`/projectAndTaskManagement/projects/${a._id}`,class:"text-decoration-none text-blue-darken-2 font-weight-medium project-name-link"},{default:l(()=>[n(d(a.name),1)]),_:2},1032,["to"])])]),s("td",null,[s("div",E,[o(q,{size:"small",color:"blue-darken-2"},{default:l(()=>{var _;return[n(d(((_=a.team)==null?void 0:_.name)||"æœªåˆ†é…åœ˜éšŠ"),1)]}),_:2},1024)])]),s("td",null,d(y(a.updatedAt)),1),s("td",null,d(y(a.createdAt)),1)])]),"no-data":l(()=>[s("div",G,[o(p,{size:"64",color:"grey-lighten-1"},{default:l(()=>[n(d(r.value?"mdi-magnify":"mdi-folder-outline"),1)]),_:1}),s("p",J,d(r.value?"æ‰¾ä¸åˆ°ç¬¦åˆæœå°‹æ¢ä»¶çš„æ­·å²å°ˆæ¡ˆ":"å°šç„¡æ­·å²å°ˆæ¡ˆ"),1)])]),_:1},8,["items","loading"])])]),_:1}),o(N,{class:"px-6 pb-4"},{default:l(()=>[o(V),o(h,{color:"grey-darken-1",variant:"outlined",onClick:v},{default:l(()=>e[6]||(e[6]=[n(" é—œé–‰ ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},ae=S(K,[["__scopeId","data-v-68314b2a"]]);export{ae as H};

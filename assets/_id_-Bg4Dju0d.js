import{b as S,u as W}from"./vue-router-CS4OewbW.js";import{i as H}from"./vuetify-use-dialog-C5oZ13xz.js";import{_ as P,b as j}from"./index-ZcDhEpUM.js";import{q as E,Q as O,w as r,g as w,J as q,F as G,r as c,a as _,c as b,v as z,b as V,D as J,x as K,y as Q}from"./vuetify-CbddcmEc.js";import{r as C,k as Z,aV as u,Z as f,bH as a,a8 as s,u as X,a7 as p,a0 as o,$ as M,bf as d,F as T,b0 as Y,_ as ee}from"./@vue-Cr_z6yfx.js";/* empty css             */import"./pinia-DBRIaiZ_.js";import"./vue-demi-Dq6ymT-8.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./jspdf-DacfHTdZ.js";import"./core-js-D2hAHviU.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./unplugin-vue-router-B1N3mqWX.js";import"./axios-upsvKRUO.js";import"./vue3-google-login-Dx7TV_Hx.js";import"./vue-easy-lightbox-D952uME8.js";import"./perfect-debounce-Cp2ysxOb.js";import"./hookable-B8xFkYCm.js";const te={class:"mb-2 announcement-title"},se={class:"d-flex align-center gap-2"},ae={class:"info-value"},ne={class:"info-value"},oe={class:"info-value"},le={class:"info-value"},ie=["innerHTML"],re={class:"text-grey-darken-2 sub-title-1 font-weight-bold ms-1"},de={class:"text-blue-grey-darken-2 sub-title-1 font-weight-bold me-1"},ce={class:"text-grey-darken-2 sub-title-2 font-weight-bold ms-1"},ue={__name:"[id]",setup(me){const y=S(),B=W(),x=H(),{apiAuth:k}=j(),l=C(null),g=C(!0),{smAndUp:L}=E(),A=async()=>{var e,t;try{g.value=!0;const n=await k.get(`/announcements/${y.params.id}`);l.value=n.data.result}catch(n){console.error("載入公告詳情失敗:",n),x({text:((t=(e=n.response)==null?void 0:e.data)==null?void 0:t.message)||n.message||"載入公告詳情失敗",snackbarProps:{color:"red-lighten-1"}})}finally{g.value=!1}},I=()=>{B.push("/announcement")},R=e=>({system:"系統公告",update:"更新公告",announcement:"一般公告",maintenance:"維護公告",event:"活動公告"})[e]||"一般公告",$=e=>({system:"blue-darken-2",update:"cyan-darken-3",announcement:"grey-darken-2",maintenance:"red-darken-1",event:"indigo-darken-1"})[e]||"grey",F=e=>({system:"mdi-cog-outline",update:"mdi-refresh",announcement:"mdi-bullhorn-outline",maintenance:"mdi-wrench-outline",event:"mdi-calendar-star"})[e]||"mdi-file-document-outline",h=e=>e?new Date(e).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}):"-",N=e=>{if(!e)return"0 B";const t=1024,n=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,i)).toFixed(2)} ${n[i]}`},D=e=>e?e.startsWith("image/")?"mdi-file-image":e.startsWith("video/")?"mdi-file-video":e.startsWith("audio/")?"mdi-file-music":e.includes("pdf")?"mdi-file-pdf-box":e.includes("word")?"mdi-file-word":e.includes("excel")||e.includes("spreadsheet")?"mdi-file-excel":e.includes("powerpoint")||e.includes("presentation")?"mdi-file-powerpoint":e.includes("zip")||e.includes("rar")||e.includes("7z")?"mdi-folder-zip":e.includes("text")?"mdi-file-document":"mdi-file":"mdi-file",U=async e=>{var t,n;try{const i=await k.get(`/announcements/${y.params.id}/download/${e.filename}`,{responseType:"blob"}),v=window.URL.createObjectURL(i.data),m=document.createElement("a");m.href=v,m.download=e.originalName,document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(v)}catch(i){console.error("下載失敗:",i),x({text:((n=(t=i.response)==null?void 0:t.data)==null?void 0:n.message)||"下載失敗，請稍後再試",snackbarProps:{color:"red-lighten-1"}})}};return Z(()=>{A()}),(e,t)=>(u(),f(O,{"max-width":"1200"},{default:a(()=>[s(z,{class:"elevation-4 rounded-lg py-4 py-sm-6 px-1 px-sm-10 mt-2 mt-sm-6 mx-0 mx-sm-4 mx-md-4 mb-4 bg-white"},{default:a(()=>[s(r,{cols:"12",class:"py-0"},{default:a(()=>[s(w,{"prepend-icon":"mdi-arrow-left",variant:"text",size:X(L)?"default":"small",color:"blue-grey-darken-2",class:"px-0",onClick:I},{default:a(()=>t[0]||(t[0]=[p(" 返回列表 ")])),_:1},8,["size"])]),_:1}),g.value?(u(),f(r,{key:0,cols:"12",class:"text-center py-10"},{default:a(()=>[s(q,{indeterminate:"",color:"blue-grey-darken-2",size:"60",width:"6"}),t[1]||(t[1]=o("div",{class:"mt-4 text-grey-darken-1"}," 載入中... ",-1))]),_:1})):l.value?(u(),M(T,{key:1},[s(r,{cols:"12",class:"pb-0"},{default:a(()=>[o("div",te,d(l.value.title),1),o("div",se,[s(G,{color:$(l.value.type),label:"",size:"small"},{default:a(()=>[s(c,{icon:F(l.value.type),size:"16",class:"me-1"},null,8,["icon"]),p(" "+d(R(l.value.type)),1)]),_:1},8,["color"])])]),_:1}),s(r,{cols:"12"},{default:a(()=>[s(_,{class:"info-card elevation-0"},{default:a(()=>[s(b,{class:"px-4 py-3"},{default:a(()=>[s(z,{dense:""},{default:a(()=>[s(r,{cols:"6",sm:"6",md:"2"},{default:a(()=>{var n,i;return[t[2]||(t[2]=o("div",{class:"info-label"}," 建立者 ",-1)),o("div",ae,d(((n=l.value.creator)==null?void 0:n.name)||"未知")+" ( "+d(((i=l.value.creator)==null?void 0:i.userId)||"")+" ) ",1)]}),_:1}),s(r,{cols:"6",sm:"6",md:"4"},{default:a(()=>[t[3]||(t[3]=o("div",{class:"info-label"}," 發布時間 ",-1)),o("div",ne,d(h(l.value.createdAt)),1)]),_:1}),s(r,{cols:"6",sm:"6",md:"4"},{default:a(()=>[t[4]||(t[4]=o("div",{class:"info-label"}," 更新時間 ",-1)),o("div",oe,d(h(l.value.updatedAt)),1)]),_:1}),s(r,{cols:"6",sm:"6",md:"2"},{default:a(()=>[t[5]||(t[5]=o("div",{class:"info-label"}," 瀏覽次數 ",-1)),o("div",le,[s(c,{icon:"mdi-eye",color:"grey-darken-1",size:"16",class:"me-1"}),p(" "+d(l.value.viewCount||0),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(r,{cols:"12"},{default:a(()=>[s(_,{class:"elevation-0 info-card"},{default:a(()=>[s(V,{class:"bg-blue-grey-lighten-5 py-3 ps-5"},{default:a(()=>[s(c,{icon:"mdi-text-box-outline",size:"20",class:"me-2"}),t[6]||(t[6]=o("span",{class:"card-title"},"公告內容",-1))]),_:1}),s(b,{class:"pa-6"},{default:a(()=>[o("div",{class:"announcement-content",innerHTML:l.value.content},null,8,ie)]),_:1})]),_:1})]),_:1}),l.value.attachments&&l.value.attachments.length>0?(u(),f(r,{key:0,cols:"12"},{default:a(()=>[s(_,{class:"elevation-0 info-card"},{default:a(()=>[s(V,{class:"bg-blue-grey-lighten-5 d-flex align-center py-3 ps-5"},{default:a(()=>[s(c,{icon:"mdi-paperclip",size:"20",class:"me-2"}),t[7]||(t[7]=o("span",{class:"card-title"},"附件",-1)),o("span",re,"("+d(l.value.attachments.length)+")",1)]),_:1}),s(b,{class:"px-0"},{default:a(()=>[s(J,null,{default:a(()=>[(u(!0),M(T,null,Y(l.value.attachments,(n,i)=>(u(),f(K,{key:i,class:"attachment-item px-6"},{append:a(()=>[s(w,{icon:"",variant:"text",color:"blue-grey-darken-2",size:"32",onClick:v=>U(n)},{default:a(()=>[s(c,{size:"18"},{default:a(()=>t[8]||(t[8]=[p(" mdi-download ")])),_:1})]),_:2},1032,["onClick"])]),default:a(()=>[s(Q,null,{default:a(()=>[s(c,{icon:D(n.mimetype),size:"20",color:"blue-grey-darken-2",class:"me-2"},null,8,["icon"]),o("span",de,d(n.originalName),1),o("span",ce,"("+d(N(n.size))+")",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):ee("",!0)],64)):(u(),f(r,{key:2,cols:"12",class:"text-center py-10"},{default:a(()=>[s(c,{icon:"mdi-alert-circle",size:"64",color:"grey-darken-1",class:"mb-4"}),t[9]||(t[9]=o("h3",{class:"text-grey-darken-1"}," 找不到此公告 ",-1))]),_:1}))]),_:1})]),_:1}))}},Ie=P(ue,[["__scopeId","data-v-5ab75ce3"]]);export{Ie as default};

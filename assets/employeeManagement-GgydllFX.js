import{f as fe,r as V,w as ua,k as ia,aV as c,Z as U,bH as t,b2 as da,a8 as l,a7 as r,a0 as g,bJ as Ie,bf as k,u as o,$ as T,_ as S,aG as tl,aH as wl,F as sl,bM as ma,b0 as Dl}from"./@vue-Cr_z6yfx.js";import{l as pa}from"./lodash-CiJWSuVn.js";import{_ as ca,u as va,a as fa,b as ga}from"./index-wwmbXvRV.js";import{i as ya}from"./vuetify-use-dialog-C5oZ13xz.js";import{u as ba}from"./vue-router-CS4OewbW.js";import{C as xa}from"./ConfirmDeleteDialogWithTextField-Dbb5flU2.js";import{c as $,e as Je,b as ka}from"./yup-WHNMwcW8.js";import{u as Va,a as z}from"./vee-validate-BXV9nMa7.js";import{q as wa,Q as Da,w as u,v as E,a as A,b as Cl,c as q,P as j,g as v,r as y,d as W,R as Ca,C as ol,F as Sa,f as I,J as za,U as Ea,A as le,e as ae,V as te,a3 as _a,a4 as Sl,x as Ye,Y as Ua,D as zl,T as Le}from"./vuetify-CbddcmEc.js";import"./perfect-debounce-Cp2ysxOb.js";import"./hookable-B8xFkYCm.js";import"./core-js-D2hAHviU.js";/* empty css             */import"./pinia-DBRIaiZ_.js";import"./vue-demi-Dq6ymT-8.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./jspdf-DacfHTdZ.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./unplugin-vue-router-B1N3mqWX.js";import"./axios-upsvKRUO.js";import"./vue3-google-login-Dx7TV_Hx.js";import"./vue-easy-lightbox-D952uME8.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-DzadwsAs.js";const Ta={key:0},ha={key:0,class:"d-flex align-center px-3 py-2 bg-light-blue text-white"},Pa={class:"d-flex align-center px-3 py-2 bg-light-blue-darken-3 text-white"},$a={class:"d-flex align-center px-3 py-2 bg-light-blue-darken-1 text-white"},Ia={key:1},La={key:2},ja={key:3},Ra={key:4},Ma={key:5},Na={key:6,class:"pa-2"},Oa={key:7},Fa={class:"menu-header px-3 py-2"},Aa={class:"menu-card-text pa-4 pt-3"},qa={class:"text-center"},Ba={class:"card-title px-8 py-4 bg-blue-grey-darken-2 d-flex align-center"},Xa={key:0,class:"d-flex justify-center align-center",style:{"min-height":"458px"}},Wa={class:"card-title px-6 py-3 bg-red-lighten-1 d-flex align-center"},Ha={class:"card-title px-6 py-3 bg-amber-darken-4 d-flex align-center"},Ga={class:"card-title px-6 py-3 bg-teal-darken-1 d-flex align-center"},Ja={class:"card-title px-6 py-3 bg-deep-orange-darken-2 d-flex align-center"},Ya={key:0},Qa={key:1},Za={key:0},Ka={key:1},et={class:"card-title px-6 py-3 bg-light-blue-darken-2 d-flex align-center"},lt={class:"card-title px-6 py-3 bg-teal-darken-1 d-flex align-center"},at={class:"mb-4"},tt={class:"text-teal-darken-1 font-weight-bold"},st={class:"mb-4"},ot={class:"text-blue-darken-1 font-weight-bold"},nt={class:"card-title px-6 py-3 bg-light-blue-darken-2 d-flex align-center"},rt={class:"text-subtitle-1 font-weight-bold text-teal-lighten-1 mb-2"},ut={class:"text-subtitle-1 font-weight-bold text-red-lighten-1 mb-2"},it={__name:"employeeManagement",setup(dt){const{apiAuth:B}=ga(),w=ya(),nl=va(),rl=fa(),ul=ba(),{smAndUp:ie,mdAndUp:ge,lgAndUp:Qe}=wa(),_=fe(()=>ie.value?"default":"small"),ye=fe(()=>ie.value?"32":"small"),El=fe(()=>ge.value?"1200":"100%"),Ze=fe(()=>rl.hasPermission("SYSTEM_USER_CREATE")),je=[{title:"科威員編",key:"employeeCode",minWidth:"80px",align:"start",sortable:!0},{title:"系統編號",key:"employeeId",minWidth:"120px",align:"start",sortable:!0},{title:"姓名",key:"name",minWidth:"90px",align:"start",sortable:!0},{title:"公司",key:"company.name",minWidth:"90px",align:"start",sortable:!0},{title:"部門",key:"department.name",align:"start",sortable:!0},{title:"聘僱類型",key:"employmentType",align:"start",sortable:!0},{title:"職稱",key:"jobTitle",align:"start",sortable:!0},{title:"Email",key:"email",align:"start",sortable:!0},{title:"狀態",key:"employmentStatus",width:"100px",align:"start",sortable:!0},{title:"備註",key:"note",width:"160px",align:"start",sortable:!0},{title:"操作",key:"actions",minWidth:"130px",align:"center",sortable:!1}],be=V(!1),il=V([]),xe=V(1),ke=V(10),dl=V(0),Ve=V([{key:"employeeCode",order:"asc"}]),we=V(""),De=V([]),Ce=V([]),m=V({company:"",department:"",employmentType:"",jobTitle:"",status:"在職",dateType:"",dateRange:[]}),M=V({open:!1,id:null}),se=V({open:!1,id:"",name:""}),de=[{title:"在職",value:"在職"},{title:"離職",value:"離職"},{title:"留職停薪",value:"留職停薪"},{title:"待入職",value:"待入職"}],_l=[{title:"到職日期",value:"hireDate"},{title:"離職日期",value:"resignationDate"},{title:"留停開始日期",value:"unpaidLeaveStartDate"},{title:"留停復職日期",value:"reinstatementDate"}],Ul=fe(()=>ie.value?ge.value?Qe.value?je:je.filter(s=>!["employeeId","note"].includes(s.key)):je.filter(s=>["employeeCode","name","company.name","department.name","jobTitle","actions"].includes(s.key)):je.filter(s=>["employeeCode","name","actions"].includes(s.key))),Tl=async()=>{var s,e;try{const{data:n}=await B.get("/companies/all");n.success&&(De.value=n.result.data)}catch(n){console.error("載入公司列表失敗:",n),w({text:((e=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:e.message)||"載入公司列表失敗",snackbarProps:{color:"red-lighten-1"}})}},hl=async()=>{var s,e;if(m.value.department="",!m.value.company){Ce.value=[];return}try{const{data:n}=await B.get("/departments/suggestions",{params:{company:m.value.company}});n.success&&(Ce.value=n.result)}catch(n){console.error("載入部門列表失敗:",n),w({text:((e=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:e.message)||"載入部門列表失敗",snackbarProps:{color:"red-lighten-1"}}),Ce.value=[]}},Pl=()=>{m.value.dateRange=[]},$l=s=>{m.value.dateRange=s},H=async()=>{var s,e,n,a;be.value=!0;try{const d={page:xe.value,itemsPerPage:ke.value,sortBy:((s=Ve.value[0])==null?void 0:s.key)||"employeeId",sortOrder:((e=Ve.value[0])==null?void 0:e.order)||"asc",quickSearch:we.value,company:m.value.company,department:m.value.department,employmentType:m.value.employmentType,jobTitle:m.value.jobTitle,status:m.value.status};if(ke.value===-1&&(d.page=1),m.value.dateType&&Array.isArray(m.value.dateRange)&&m.value.dateRange.length>0){const b=new Date(m.value.dateRange[0]),D=new Date(m.value.dateRange[m.value.dateRange.length-1]);b.setHours(0,0,0,0),D.setHours(23,59,59,999),d.dateType=m.value.dateType,d.dateStart=b.toISOString(),d.dateEnd=D.toISOString()}const{data:p}=await B.get("/employees/all",{params:d});p.success&&(il.value=p.result.data,dl.value=p.result.totalItems)}catch(d){console.error("搜尋失敗:",d),w({text:((a=(n=d==null?void 0:d.response)==null?void 0:n.data)==null?void 0:a.message)||"搜尋失敗",snackbarProps:{color:"red-lighten-1"}})}finally{be.value=!1}},Il=()=>{m.value={company:"",department:"",employmentType:"",jobTitle:"",status:"在職",dateType:"",dateRange:[]},we.value="",Ce.value=[],H()},Ll=async s=>{var e;s.itemsPerPage===-1?xe.value=1:xe.value=s.page,ke.value=s.itemsPerPage,((e=s.sortBy)==null?void 0:e.length)>0&&(Ve.value=s.sortBy),await H()},jl=pa.debounce(()=>{xe.value=1,H()},300);ua(we,()=>{jl()}),ia(async()=>{await Promise.all([Tl(),H()])});const Rl=s=>{se.value={open:!0,id:s._id,name:s.name}},Ml=async()=>{var s,e,n;try{const{data:a}=await B.delete(`/employees/${se.value.id}`);a.success&&(await H(),se.value.open=!1,(s=a.result)!=null&&s.affectedUser?w({text:`員工已刪除，相關系統用戶「${a.result.affectedUser.name}」的關聯已解除`,snackbarProps:{color:"orange-darken-1"}}):w({text:"刪除員工成功",snackbarProps:{color:"teal-lighten-1"}}))}catch(a){w({text:((n=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:n.message)||"刪除失敗",snackbarProps:{color:"red-lighten-1"}})}},Re=V([]),ml=async()=>{var s,e;if(Se.value.value="",Re.value=[],!!oe.value.value)try{const{data:n}=await B.get("/departments/suggestions",{params:{company:oe.value.value}});n.success&&(Re.value=n.result)}catch(n){console.error("載入部門列表失敗:",n),w({text:((e=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:e.message)||"載入部門列表失敗",snackbarProps:{color:"red-lighten-1"}})}},Me=V(!1),Nl=fe(()=>{const s={company:$().required("請選擇公司"),department:$().required("請選擇部門"),name:$().required("請輸入姓名").trim(),nickname:$().nullable().trim(),lineID:$().nullable().trim(),lineLink:$().nullable().trim(),email:$().nullable().test("email-format",e=>(!e||e.trim()==="",!0)).email("請輸入正確的 Email 格式"),emailPassword:$().nullable(),employeeCode:$().required("請輸入科威員工編號"),extNumber:$().required("請輸入分機號碼"),printNumber:$().required("請輸入列印編號"),employmentStatus:$().required("請選擇任職狀態"),employmentType:$().required("請選擇聘僱類型"),jobTitle:$().required("請選擇職稱"),hireDate:Je().required("請選擇到職日期"),resignationDate:Je().nullable(),unpaidLeaveStartDate:Je().nullable(),reinstatementDate:Je().nullable(),note:$().nullable()};return M.value.id&&(s.employeeId=$().required("請輸入系統員工編號")),ka(s)}),{handleSubmit:Ol,isSubmitting:pl,resetForm:cl}=Va({validationSchema:Nl,initialValues:{company:"",department:"",name:"",nickname:"",lineID:"",lineLink:"",email:"",emailPassword:"",employeeCode:"",extNumber:"",printNumber:"",employmentStatus:"在職",employmentType:"正職",jobTitle:"",note:"",hireDate:null,resignationDate:null,unpaidLeaveStartDate:null,reinstatementDate:null}}),oe=z("company"),Se=z("department"),Ne=z("name"),ne=z("email"),Oe=z("emailPassword"),ze=z("employeeCode"),Ee=z("extNumber"),_e=z("printNumber"),re=z("employmentStatus"),Fe=z("employmentType"),Ae=z("jobTitle"),qe=z("note"),me=z("employeeId"),Ue=z("hireDate"),Q=z("resignationDate"),Z=z("unpaidLeaveStartDate"),G=z("reinstatementDate"),Be=z("nickname"),Xe=z("lineID"),We=z("lineLink"),Fl=s=>{s==="離職"?N.value={open:!0,date:null,error:""}:s==="留職停薪"?(G.value.value=null,O.value={open:!0,date:null,error:""}):(s==="在職"||s==="待入職")&&(Q.value.value=null,Z.value.value&&!G.value.value&&(F.value={open:!0,date:null,error:""}))},Al=()=>{if(!N.value.date){N.value.error="請選擇離職日期";return}Q.value.value=N.value.date,N.value.open=!1,N.value.error=""},ql=()=>{if(!O.value.date){O.value.error="請選擇留停開始日期";return}Z.value.value=O.value.date,G.value.value=null,O.value.open=!1,O.value.error=""},Bl=()=>{if(!F.value.date){F.value.error="請選擇留停復職日期";return}G.value.value=F.value.date,F.value.open=!1,F.value.error=""},vl=async s=>{var e,n,a,d,p;M.value.open=!0,M.value.id=(s==null?void 0:s._id)||null,Me.value=!0;try{s?(oe.value.value=((e=s.company)==null?void 0:e._id)||"",(n=s.company)!=null&&n._id&&await ml(),Se.value.value=((a=s.department)==null?void 0:a._id)||"",Ne.value.value=s.name||"",Be.value.value=s.nickname||"",Xe.value.value=s.lineID||"",We.value.value=s.lineLink||"",ne.value.value=s.email??"",Oe.value.value=s.emailPassword||"",ze.value.value=s.employeeCode||"",Ee.value.value=s.extNumber||"",_e.value.value=s.printNumber||"",re.value.value=s.employmentStatus||"在職",Fe.value.value=s.employmentType||"正職",Ae.value.value=s.jobTitle||"",qe.value.value=s.note||"",me.value&&(me.value.value=s.employeeId||""),Ue.value.value=s.hireDate?new Date(s.hireDate):null,Q.value.value=s.resignationDate?new Date(s.resignationDate):null,Z.value.value=s.unpaidLeaveStartDate?new Date(s.unpaidLeaveStartDate):null,G.value.value=s.reinstatementDate?new Date(s.reinstatementDate):null):cl()}catch(b){console.error("載入員工資料失敗:",b),w({text:((p=(d=b==null?void 0:b.response)==null?void 0:d.data)==null?void 0:p.message)||"載入員工資料失敗",snackbarProps:{color:"red-lighten-1"}}),Te()}finally{Me.value=!1}},Te=()=>{M.value.open=!1,M.value.id=null,Me.value=!1,cl(),Re.value=[]},Xl=Ol(async s=>{var e,n,a,d;try{if(M.value.id){const{data:p}=await B.patch(`/employees/${M.value.id}`,s);if(p.success){if(s.employmentStatus)try{await B.patch(`/employees/${M.value.id}/status-change`,{employmentStatus:s.employmentStatus})}catch(b){console.warn("更新用戶狀態失敗:",b)}await H(),Te(),w({text:"員工資料更新成功",snackbarProps:{color:"teal-lighten-1"}})}}else{const{data:p}=await B.post("/employees",s);p.success&&(await H(),Te(),w({text:"新增員工成功",snackbarProps:{color:"teal-lighten-1"}}))}}catch(p){const b=(n=(e=p==null?void 0:p.response)==null?void 0:e.data)==null?void 0:n.message,D=(d=(a=p==null?void 0:p.response)==null?void 0:a.data)==null?void 0:d.field;if(D)switch(D){case"email":ne.setErrors([b]);break;case"employeeId":me.setErrors([b]);break;case"employeeCode":ze.setErrors([b]);break;case"extNumber":Ee.setErrors([b]);break;case"printNumber":_e.setErrors([b]);break}w({text:b||"操作失敗",snackbarProps:{color:"red-lighten-1"}})}}),N=V({open:!1,date:null,error:""}),O=V({open:!1,date:null,error:""}),F=V({open:!1,date:null,error:""}),fl=()=>{N.value.open=!1,N.value.error="",re.value.value="在職"},gl=()=>{O.value.open=!1,O.value.error="",re.value.value="在職"},yl=()=>{F.value.open=!1,F.value.error="",re.value.value="留職停薪"},Wl=s=>{switch(s){case"在職":return"teal-lighten-1";case"離職":return"grey";case"留職停薪":return"amber-darken-2";case"待入職":return"light-blue-darken-1";default:return"grey"}},He=s=>s?new Date(s).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}):"",he=V(!1),i=V({open:!1,type:"all",company:null,departments:[],departmentOptions:[],employmentStatus:[],companyError:"",departmentError:"",employmentStatusError:""}),bl=async()=>(window.XLSX||await new Promise((s,e)=>{const n=document.createElement("script");n.src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js",n.onload=s,n.onerror=e,document.head.appendChild(n)}),window.XLSX),Hl=()=>{i.value={open:!0,type:"all",company:null,departments:[],departmentOptions:[],employmentStatus:[],companyError:"",departmentError:"",employmentStatusError:""}},Ke=()=>{i.value.open=!1},Gl=async s=>{var e,n,a;if(i.value.departments=[],i.value.departmentOptions=[],i.value.companyError="",i.value.departmentError="",!!s)try{const{data:d}=await B.get("/departments/suggestions",{params:{company:s}});d.success&&(i.value.departmentOptions=d.result)}catch(d){console.error("Error:",d);const p=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"操作失敗";((a=d==null?void 0:d.response)==null?void 0:a.status)===401?(nl.logout(),ul.push("/login"),w({text:"登入已過期，請重新登入",snackbarProps:{color:"red-lighten-1"}})):w({text:p,snackbarProps:{color:"red-lighten-1"}})}},Jl=()=>{i.value.departmentError="",i.value.departments.length===i.value.departmentOptions.length?i.value.departments=[]:i.value.departments=i.value.departmentOptions.map(s=>s._id)},Yl=()=>{i.value.employmentStatusError="",i.value.employmentStatus.length===de.length?i.value.employmentStatus=[]:i.value.employmentStatus=de.map(s=>s.value)},Ql=async()=>{var s,e,n,a;try{let d=!1;if(i.value.companyError="",i.value.departmentError="",i.value.employmentStatusError="",(!i.value.employmentStatus||i.value.employmentStatus.length===0)&&(i.value.employmentStatusError="請選擇至少一個任職狀態",d=!0),i.value.type==="company"&&(i.value.company||(i.value.companyError="請選擇公司",d=!0),i.value.company&&(!i.value.departments||i.value.departments.length===0)&&(i.value.departmentError="請選擇至少一個部門",d=!0)),d)return;he.value=!0;const p={type:i.value.type};i.value.type==="company"&&(p.company=i.value.company,i.value.departments.length>0&&(p.departments=i.value.departments.join(","))),i.value.employmentStatus.length>0&&(p.employmentStatus=i.value.employmentStatus.join(","));const{data:b}=await B.get("/employees/export",{params:p});if(b.success){const D=await bl(),K=b.result.map(x=>{var $e,ce;const Pe=f=>{if(!f)return"";const L=new Date(f),ve=L.getFullYear(),h=String(L.getMonth()+1).padStart(2,"0"),R=String(L.getDate()).padStart(2,"0");return`${ve}/${h}/${R}`};return{科威員編:x.employeeCode,姓名:x.name,暱稱:x.nickname||"",LineID:x.lineID||"",Line連結:x.lineLink||"",公司:(($e=x.company)==null?void 0:$e.name)||"",部門:((ce=x.department)==null?void 0:ce.name)||"",聘僱類型:x.employmentType||"正職",職稱:x.jobTitle||"",分機號碼:x.extNumber,列印編號:x.printNumber,Email:x.email,Email密碼:x.emailPassword,任職狀態:x.employmentStatus,到職日期:Pe(x.hireDate),離職日期:Pe(x.resignationDate),留停開始日期:Pe(x.unpaidLeaveStartDate),留停復職日期:Pe(x.reinstatementDate),備註:x.note||""}}),ue=D.utils.json_to_sheet(K),ee={科威員編:15,姓名:15,暱稱:15,LineID:15,Line連結:30,公司:20,部門:20,聘僱類型:12,職稱:12,分機號碼:12,列印編號:12,Email:30,Email密碼:15,任職狀態:12,到職日期:15,離職日期:15,留停開始日期:15,留停復職日期:15,備註:40};ue["!cols"]=Object.values(ee).map(x=>({wch:x}));const Y=D.utils.book_new();D.utils.book_append_sheet(Y,ue,"員工資料");const al=i.value.type==="all"?"所有員工資料清單.xlsx":`${(s=De.value.find(x=>x._id===i.value.company))==null?void 0:s.name}員工資料清單.xlsx`;D.writeFile(Y,al),Ke(),w({text:"Excel 匯出成功",snackbarProps:{color:"teal-lighten-1"}})}}catch(d){console.error("Error:",d);const p=((n=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:n.message)||"操作失敗";((a=d==null?void 0:d.response)==null?void 0:a.status)===401?(nl.logout(),ul.push("/login"),w({text:"登入已過期，請重新登入",snackbarProps:{color:"red-lighten-1"}})):w({text:p,snackbarProps:{color:"red-lighten-1"}})}finally{he.value=!1}},Zl=()=>{const s=ne.value.value||"";if(s.includes("@ystravel.com.tw"))return;const e=s.split("@")[0];e&&e.trim()!==""&&(ne.value.value=`${e}@ystravel.com.tw`)},pe=V(!1),X=V({open:!1,file:null,fileError:""}),J=V({open:!1,success:[],errors:[]}),C=V({open:!1,employee:null,selectedRole:0,roleError:""}),el=V([]);(async()=>{try{const s=await rl.getAllRoles();console.log("載入的角色列表:",s),el.value=s.filter(e=>e.isActive).map(e=>({value:e._id,title:e.name,description:e.description})),console.log("處理後的角色選項:",el.value)}catch(s){console.error("載入角色列表失敗:",s),w({text:"載入角色列表失敗",snackbarProps:{color:"red-lighten-1"}})}})();const Kl=()=>{X.value={open:!0,file:null,fileError:""}},ll=()=>{X.value.open=!1},xl=()=>{J.value.open=!1},ea=()=>{X.value.fileError=""},la=async()=>{var s,e;try{let n=!1;if(X.value.fileError="",X.value.file||(X.value.fileError="請選擇檔案",n=!0),n)return;pe.value=!0;const a=await bl(),d=new FileReader;d.onload=async p=>{var b,D;try{const K=new Uint8Array(p.target.result),ue=a.read(K,{type:"array",cellDates:!0,dateNF:"yyyy/mm/dd"}),ee=ue.Sheets[ue.SheetNames[0]],Y=a.utils.decode_range(ee["!ref"]),al=["科威員編","Email密碼"],x=[];for(let f=Y.s.c;f<=Y.e.c;++f){const L=ee[a.utils.encode_cell({r:Y.s.r,c:f})];L&&al.includes(L.v)&&x.push(f)}for(let f=Y.s.r+1;f<=Y.e.r;++f)for(const L of x){const ve=a.utils.encode_cell({r:f,c:L}),h=ee[ve];if(h){if(h.t==="n"){let R=h.v.toString();const P=ee[a.utils.encode_cell({r:Y.s.r,c:L})];P&&P.v==="科威員編"&&/^\d+$/.test(R)&&R.length<4&&(R=R.padStart(4,"0")),h.t="s",h.v=R,h.w=R}else if(h.t==="s"&&h.v){const R=ee[a.utils.encode_cell({r:Y.s.r,c:L})];if(R&&R.v==="科威員編"){let P=h.v.toString().trim();/^\d+$/.test(P)&&P.length<4&&(P=P.padStart(4,"0"),h.v=P,h.w=P)}}}}const $e=a.utils.sheet_to_json(ee,{raw:!1,defval:"",dateNF:"yyyy/mm/dd"}).map(f=>{var ve,h,R;const L=P=>{if(!P)return"";if(typeof P=="number"){const Ge=new Date(1899,11,30);return new Date(Ge.getTime()+P*24*60*60*1e3).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"/")}if(typeof P=="string"){const Ge=new Date(P);if(!isNaN(Ge.getTime()))return Ge.toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"/")}return P};return console.log("Excel 原始日期:",{hireDate:f.到職日期,type:typeof f.到職日期}),{employeeCode:(ve=f.科威員編)==null?void 0:ve.toString(),name:f.姓名,nickname:f.暱稱,lineID:f.LineID,lineLink:f.Line連結,company:f.公司,department:f.部門,employmentType:f.聘僱類型||"正職",jobTitle:f.職稱||"",extNumber:(h=f.分機號碼)==null?void 0:h.toString().trim(),printNumber:(R=f.列印編號)==null?void 0:R.toString().trim(),email:f.Email,emailPassword:f.Email密碼,employmentStatus:f.任職狀態,hireDate:L(f.到職日期),resignationDate:L(f.離職日期),unpaidLeaveStartDate:L(f.留停開始日期),reinstatementDate:L(f.留停復職日期),note:f.備註}});console.log("處理後的匯入資料:",JSON.stringify($e,null,2));const{data:ce}=await B.post("/employees/import",{employees:$e});ce.success&&(J.value={open:!0,success:ce.result.success,errors:ce.result.errors},ll(),await H(),w({text:"匯入完成",snackbarProps:{color:"teal-lighten-1"}}))}catch(K){console.error("Error:",K);const ue=((D=(b=K==null?void 0:K.response)==null?void 0:b.data)==null?void 0:D.message)||"匯入失敗";w({text:ue,snackbarProps:{color:"red-lighten-1"}})}finally{pe.value=!1}},d.readAsArrayBuffer(X.value.file)}catch(n){console.error("Error:",n);const a=((e=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:e.message)||"匯入失敗";w({text:a,snackbarProps:{color:"red-lighten-1"}}),pe.value=!1}},aa=()=>{const s=document.createElement("a");s.href="https://eip.ystravel.com.tw/GInternational/uploads/example/example_employeeList.xlsx",s.download="example_employeeList.xlsx",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),w({text:"範例檔案下載成功",snackbarProps:{color:"teal-lighten-1"}})},ta=s=>{switch(s.employmentStatus){case"在職":return"mdi-calendar-check";case"離職":return"mdi-calendar-remove";case"留職停薪":return"mdi-calendar-clock";case"待入職":return"mdi-calendar-arrow-right";default:return"mdi-calendar"}},sa=s=>{switch(s.employmentStatus){case"在職":return`到職日期：${He(s.hireDate)}`;case"離職":return`離職日期：${He(s.resignationDate)}`;case"待入職":return`到職日期：${He(s.hireDate)}`;case"留職停薪":return`留停開始日期：${He(s.unpaidLeaveStartDate)}`;default:return""}},oa=s=>{switch(s.employmentStatus){case"在職":return"bg-teal-lighten-1 text-white";case"離職":return"bg-grey text-white";case"留職停薪":return"bg-amber-darken-2 text-white";case"待入職":return"bg-light-blue-darken-1 text-white";default:return"bg-grey text-white"}},kl=[{text:"正職",value:"正職"},{text:"兼職",value:"兼職"},{text:"實習生",value:"實習生"}],Vl=[{text:"董事長",value:"董事長"},{text:"總經理",value:"總經理"},{text:"副總經理",value:"副總經理"},{text:"協理",value:"協理"},{text:"總監",value:"總監"},{text:"部長",value:"部長"},{text:"經理",value:"經理"},{text:"票務經理",value:"票務經理"},{text:"專案經理",value:"專案經理"},{text:"副理",value:"副理"},{text:"主任",value:"主任"},{text:"業務代表",value:"業務代表"},{text:"OP",value:"OP"},{text:"線控",value:"線控"},{text:"線控助理",value:"線控助理"},{text:"日本線控",value:"日本線控"},{text:"日本手配",value:"日本手配"},{text:"財務",value:"財務"},{text:"美編",value:"美編"},{text:"行銷",value:"行銷"},{text:"網頁設計",value:"網頁設計"},{text:"工程師",value:"工程師"},{text:"人事行政專員",value:"人事行政專員"},{text:"行政專員",value:"行政專員"},{text:"總務專員",value:"總務專員"},{text:"財務助理",value:"財務助理"},{text:"業務助理",value:"業務助理"},{text:"OP助理",value:"OP助理"},{text:"團體機位助理",value:"團體機位助理"},{text:"美編助理",value:"美編助理"},{text:"外務",value:"外務"},{text:"旅遊經理人",value:"旅遊經理人"},{text:"旅遊規劃師",value:"旅遊規劃師"},{text:"旅遊專案企劃專員",value:"旅遊專案企劃專員"},{text:"助理工程師",value:"助理工程師"},{text:"Indoor",value:"Indoor"},{text:"工讀生",value:"工讀生"},{text:"實習生",value:"實習生"},{text:"顧問",value:"顧問"}],na=s=>{C.value={open:!0,employee:s,selectedRole:null,roleError:""}},ra=async()=>{var e,n;if(C.value.selectedRole===null||C.value.selectedRole===void 0){C.value.roleError="請選擇權限";return}const s=C.value.employee;console.log("準備發送請求:",{employeeId:s._id,selectedRole:C.value.selectedRole,roleId:C.value.selectedRole});try{const{data:a}=await B.post(`/employees/${s._id}/copy-to-user`,{roleId:C.value.selectedRole,password:`ys${s.extNumber}${s.printNumber}`});if(a.success){C.value.open=!1,await H();const d=a.message.includes("建立關聯")?`員工 ${s.name} 已與現有系統用戶建立關聯`:`員工 ${s.name} 已成功新增為系統用戶`;w({text:d,snackbarProps:{color:"teal-lighten-1"}})}}catch(a){console.error("複製員工為用戶失敗:",a),w({text:((n=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:n.message)||"複製失敗",snackbarProps:{color:"red-lighten-1"}})}};return(s,e)=>{const n=da("v-date-input");return c(),U(Da,{"max-width":"2500"},{default:t(()=>[l(E,{class:"pt-md-5"},{default:t(()=>[l(u,{cols:"12",lg:"2"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12",class:"mt-1 px-lg-5"},{default:t(()=>[l(A,{class:"elevation-4 rounded-lg py-6 px-4 px-sm-2 px-xl-4"},{default:t(()=>[l(Cl,{class:"font-weight-bold d-flex align-center mb-2"},{default:t(()=>e[58]||(e[58]=[r(" 搜尋條件 ")])),_:1}),l(q,{class:"pa-2"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.company,"onUpdate:modelValue":[e[0]||(e[0]=a=>m.value.company=a),hl],items:De.value,"item-title":a=>a?`${a.name} (${a.companyId})`:"","item-value":"_id",label:"公司",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items","item-title"])]),_:1}),l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.department,"onUpdate:modelValue":e[1]||(e[1]=a=>m.value.department=a),items:Ce.value,"item-title":a=>a?`${a.name} (${a.departmentId})`:"","item-value":"_id",label:"部門",variant:"outlined",density:"compact","hide-details":"",clearable:"",disabled:!m.value.company},null,8,["modelValue","items","item-title","disabled"])]),_:1}),l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.employmentType,"onUpdate:modelValue":e[2]||(e[2]=a=>m.value.employmentType=a),items:kl,label:"聘僱類型","item-title":"text","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.jobTitle,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value.jobTitle=a),items:Vl,label:"職稱","item-title":"text","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.status,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value.status=a),items:de,label:"任職狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(E,{class:"border rounded-lg border border-opacity-25 mb-2 mx-0"},{default:t(()=>[l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(j,{modelValue:m.value.dateType,"onUpdate:modelValue":[e[5]||(e[5]=a=>m.value.dateType=a),Pl],items:_l,label:"日期類型",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[l(n,{modelValue:m.value.dateRange,"onUpdate:modelValue":[e[6]||(e[6]=a=>m.value.dateRange=a),$l],label:"日期區間",variant:"outlined",density:"compact","prepend-icon":"","hide-details":"",clearable:"",multiple:"range",disabled:!m.value.dateType,"cancel-text":"取消","ok-text":"確認"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),l(E,null,{default:t(()=>[l(u,{cols:"12",class:"d-flex justify-end gap-2"},{default:t(()=>[l(E,{class:"d-flex justify-space-between"},{default:t(()=>[l(u,{cols:"3",class:"pe-0"},{default:t(()=>[l(v,{color:"grey",width:"40",block:"",onClick:Il},{default:t(()=>[l(y,null,{default:t(()=>e[59]||(e[59]=[r("mdi-refresh")])),_:1})]),_:1})]),_:1}),l(u,{cols:"8",class:"ps-0"},{default:t(()=>[l(v,{color:"cyan-darken-2","prepend-icon":"mdi-magnify",loading:be.value,block:"",onClick:H},{default:t(()=>e[60]||(e[60]=[r(" 搜尋 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12",class:"px-3 px-lg-5"},{default:t(()=>[l(A,{class:"elevation-4 rounded-lg py-3 py-sm-5 px-2 px-sm-4"},{default:t(()=>[l(Cl,{class:"font-weight-bold d-flex justify-space-between mb-2"},{default:t(()=>[e[62]||(e[62]=g("span",null,"匯入 / 匯出 Excel",-1)),Ie((c(),U(v,{icon:"",variant:"text",color:"blue-grey-darken-2",size:"28",onClick:aa},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[61]||(e[61]=[r(" mdi-download-box-outline ")])),_:1})]),_:1})),[[Le,"下載範例檔案","start"]])]),_:1}),l(q,{class:"pa-2"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"6"},{default:t(()=>[l(v,{"prepend-icon":"mdi-file-import",color:"light-blue-darken-2",block:"",size:_.value,class:"me-4",onClick:Kl},{default:t(()=>e[63]||(e[63]=[r(" 匯入 ")])),_:1},8,["size"])]),_:1}),l(u,{cols:"6"},{default:t(()=>[l(v,{"prepend-icon":"mdi-file-export",color:"deep-orange-darken-1",block:"",size:_.value,onClick:Hl},{default:t(()=>e[64]||(e[64]=[r(" 匯出 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12",lg:"10",class:"px-6 ps-lg-4 pe-lg-8 mb-6"},{default:t(()=>[l(E,{class:"elevation-4 rounded-lg py-4 py-lg-6 px-1 px-sm-4 px-lg-6 mt-1 bg-white"},{default:t(()=>[l(u,{cols:"12",class:"ps-4 pb-sm-4"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,null,{default:t(()=>e[65]||(e[65]=[g("h3",null," 員工管理 ",-1)])),_:1}),l(u,{cols:"12",class:"d-flex align-center"},{default:t(()=>[l(E,{class:"d-flex justify-space-between"},{default:t(()=>[l(u,{cols:"5",sm:"4",class:"pe-0 pe-sm-4"},{default:t(()=>[l(v,{"prepend-icon":"mdi-account-plus",variant:"outlined",color:"blue-grey-darken-2",onClick:e[7]||(e[7]=a=>vl(null))},{default:t(()=>e[66]||(e[66]=[r(" 新增員工 ")])),_:1})]),_:1}),l(u,{cols:"7",sm:"5",md:"4",lg:"3",xl:"2",class:"d-flex align-center"},{default:t(()=>[Ie(l(y,{icon:"mdi-information",size:"small",color:"blue-grey-darken-2",class:"me-2"},null,512),[[Le,"可搜尋系統員工編號、姓名、Email、科威員工編號、分機號碼、列印號碼、備註、暱稱、LineID","start"]]),l(W,{modelValue:we.value,"onUpdate:modelValue":e[8]||(e[8]=a=>we.value=a),loading:be.value,density:"compact",variant:"outlined",label:"快速搜尋","append-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12"},{default:t(()=>[l(Ca,{"items-per-page":ke.value,"onUpdate:itemsPerPage":e[9]||(e[9]=a=>ke.value=a),"sort-by":Ve.value,"onUpdate:sortBy":e[10]||(e[10]=a=>Ve.value=a),items:il.value,headers:Ul.value,loading:be.value,"items-length":dl.value,page:xe.value,hover:"",density:"compact",class:"rounded-ts-lg rounded-te-lg","onUpdate:options":Ll},{item:t(({item:a,index:d})=>{var p,b;return[g("tr",{class:wl({"odd-row":d%2===0,"even-row":d%2!==0})},[g("td",null,k(a.employeeCode),1),o(Qe)?(c(),T("td",Ta,k(a.employeeId),1)):S("",!0),g("td",null,[l(ol,{location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:D})=>[g("div",tl(D,{class:"d-flex align-center status-cell"}),k(a.name),17)]),default:t(()=>[l(A,{"min-width":"130",class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[l(q,{class:"pa-0"},{default:t(()=>[a.nickname?(c(),T("div",ha,[l(y,{size:"16",class:"me-2",color:"white"},{default:t(()=>e[67]||(e[67]=[r(" mdi-account-badge ")])),_:1}),g("span",null,"暱稱："+k(a.nickname),1)])):S("",!0),g("div",Pa,[l(y,{size:"16",class:"me-2",color:"white"},{default:t(()=>e[68]||(e[68]=[r(" mdi-phone ")])),_:1}),g("span",null,"分機號碼："+k(a.extNumber||"無"),1)]),g("div",$a,[l(y,{size:"16",class:"me-2",color:"white"},{default:t(()=>e[69]||(e[69]=[r(" mdi-printer ")])),_:1}),g("span",null,"列印編號："+k(a.printNumber||"無"),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),o(ie)?(c(),T("td",Ia,k((p=a.company)==null?void 0:p.name),1)):S("",!0),o(ie)?(c(),T("td",La,k((b=a.department)==null?void 0:b.name),1)):S("",!0),o(ge)?(c(),T("td",ja,k(a.employmentType),1)):S("",!0),o(ie)?(c(),T("td",Ra,k(a.jobTitle),1)):S("",!0),o(ge)?(c(),T("td",Ma,k(a.email),1)):S("",!0),o(ge)?(c(),T("td",Na,[l(ol,{location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:D})=>[g("div",tl(D,{class:"status-cell d-flex align-center"}),[l(Sa,{size:"small",variant:"outlined",color:Wl(a.employmentStatus)},{default:t(()=>[r(k(a.employmentStatus),1)]),_:2},1032,["color"])],16)]),default:t(()=>[l(A,{"min-width":"200",class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[l(q,{class:"pa-0"},{default:t(()=>[g("div",{class:wl(["d-flex align-center px-3 py-2",oa(a)])},[l(y,{size:"16",class:"me-2"},{default:t(()=>[r(k(ta(a)),1)]),_:2},1024),g("span",null,k(sa(a)),1)],2)]),_:2},1024)]),_:2},1024)]),_:2},1024)])):S("",!0),o(Qe)?(c(),T("td",Oa,[a.note?(c(),U(ol,{key:0,location:"top",transition:"fade-transition","close-on-content-click":!0,"close-on-back":!0},{activator:t(({props:D})=>[g("div",tl(D,{class:"note-cell"}),k(a.note),17)]),default:t(()=>[l(A,{"min-width":"300","max-width":"400",class:"rounded-lg menu-card",elevation:"3"},{default:t(()=>[l(q,{class:"pa-0"},{default:t(()=>[g("div",Fa,[l(y,{size:"16",color:"white",class:"me-2"},{default:t(()=>e[70]||(e[70]=[r(" mdi-text-box ")])),_:1}),e[71]||(e[71]=g("span",{class:"text-white text-subtitle-2"},"備註內容",-1))]),g("div",Aa,k(a.note),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(c(),T(sl,{key:1},[],64))])):S("",!0),g("td",qa,[l(v,{icon:"",color:"light-blue-darken-4",variant:"plain",size:ye.value,ripple:!1,onClick:D=>vl(a)},{default:t(()=>[l(y,null,{default:t(()=>e[72]||(e[72]=[r("mdi-pencil")])),_:1})]),_:2},1032,["size","onClick"]),Ze.value&&!a.hasSystemUser&&(a.employmentStatus==="在職"||a.employmentStatus==="待入職")?Ie((c(),U(v,{key:0,icon:"",color:"teal-darken-1",variant:"plain",size:ye.value,ripple:!1,onClick:D=>na(a)},{default:t(()=>[l(y,null,{default:t(()=>e[73]||(e[73]=[r("mdi-account-plus")])),_:1})]),_:2},1032,["size","onClick"])),[[Le,"新增為系統用戶","start"]]):Ze.value&&!a.hasSystemUser&&(a.employmentStatus==="離職"||a.employmentStatus==="留職停薪")?Ie((c(),U(v,{key:1,icon:"",color:"grey",variant:"plain",size:ye.value,ripple:!1,disabled:""},{default:t(()=>[l(y,null,{default:t(()=>e[74]||(e[74]=[r("mdi-account-plus")])),_:1})]),_:1},8,["size"])),[[Le,"離職/留停員工無法複製為系統用戶","start"]]):Ze.value&&a.hasSystemUser?Ie((c(),U(v,{key:2,icon:"",color:"grey",variant:"plain",size:ye.value,ripple:!1,disabled:""},{default:t(()=>[l(y,null,{default:t(()=>e[75]||(e[75]=[r("mdi-account-check")])),_:1})]),_:1},8,["size"])),[[Le,"已有系統用戶","start"]]):S("",!0),l(v,{icon:"",color:"red-lighten-1",variant:"plain",size:ye.value,ripple:!1,onClick:D=>Rl(a)},{default:t(()=>[l(y,null,{default:t(()=>e[76]||(e[76]=[r("mdi-delete")])),_:1})]),_:2},1032,["size","onClick"])])],2)]}),_:1},8,["items-per-page","sort-by","items","headers","loading","items-length","page"])]),_:1})]),_:1})]),_:1})]),_:1}),l(te,{modelValue:M.value.open,"onUpdate:modelValue":e[35]||(e[35]=a=>M.value.open=a),persistent:"",width:El.value,"no-click-animation":o(pl)},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",Ba,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[77]||(e[77]=[r(" mdi-account-plus ")])),_:1}),r(" "+k(M.value.id?"編輯員工資料":"新增員工")+" ",1),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:Te},{default:t(()=>[l(y,null,{default:t(()=>e[78]||(e[78]=[r("mdi-close")])),_:1})]),_:1})]),l(q,{class:"mt-6 mb-0 px-6"},{default:t(()=>[Me.value?(c(),T("div",Xa,[l(za,{indeterminate:"",color:"deep-purple-darken-2",size:"64",width:"8"})])):(c(),U(Ea,{key:1,onSubmit:ma(o(Xl),["prevent"])},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),l(u,{cols:"6",sm:"2",class:"d-flex align-center justify-center"},{default:t(()=>[l(y,{size:"18",class:"me-2"},{default:t(()=>e[79]||(e[79]=[r(" mdi-card-account-details-outline ")])),_:1}),e[80]||(e[80]=r(" 基本資料 "))]),_:1}),l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),M.value.id?(c(),U(u,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(me).value.value,"onUpdate:modelValue":e[11]||(e[11]=a=>o(me).value.value=a),"error-messages":o(me).errorMessage.value,label:"系統編號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1})):S("",!0),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(Ne).value.value,"onUpdate:modelValue":e[12]||(e[12]=a=>o(Ne).value.value=a),"error-messages":o(Ne).errorMessage.value,label:"*姓名",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(Be).value.value,"onUpdate:modelValue":e[13]||(e[13]=a=>o(Be).value.value=a),"error-messages":o(Be).errorMessage.value,label:"暱稱",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(Xe).value.value,"onUpdate:modelValue":e[14]||(e[14]=a=>o(Xe).value.value=a),"error-messages":o(Xe).errorMessage.value,label:"LineID",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(We).value.value,"onUpdate:modelValue":e[15]||(e[15]=a=>o(We).value.value=a),"error-messages":o(We).errorMessage.value,label:"Line連結",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),l(u,{cols:"6",sm:"2",class:"d-flex align-center justify-center"},{default:t(()=>[l(y,{size:"18",class:"me-2"},{default:t(()=>e[81]||(e[81]=[r(" mdi-office-building-outline ")])),_:1}),e[82]||(e[82]=r(" 任職資料 "))]),_:1}),l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(j,{modelValue:o(oe).value.value,"onUpdate:modelValue":[e[16]||(e[16]=a=>o(oe).value.value=a),ml],"error-messages":o(oe).errorMessage.value,items:De.value,"item-title":a=>a?`${a.name} (${a.companyId})`:"","item-value":"_id",label:"*公司",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages","items","item-title"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(j,{modelValue:o(Se).value.value,"onUpdate:modelValue":e[17]||(e[17]=a=>o(Se).value.value=a),"error-messages":o(Se).errorMessage.value,items:Re.value,"item-title":a=>a?`${a.name} (${a.departmentId})`:"","item-value":"_id",label:"*部門",variant:"outlined",density:"compact",clearable:"",disabled:!o(oe).value.value},null,8,["modelValue","error-messages","items","item-title","disabled"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(j,{modelValue:o(Fe).value.value,"onUpdate:modelValue":e[18]||(e[18]=a=>o(Fe).value.value=a),"error-messages":o(Fe).errorMessage.value,items:kl,"item-title":"text","item-value":"value",label:"*聘僱類型",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(j,{modelValue:o(Ae).value.value,"onUpdate:modelValue":e[19]||(e[19]=a=>o(Ae).value.value=a),"error-messages":o(Ae).errorMessage.value,items:Vl,"item-title":"text","item-value":"value",label:"*職稱",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(ze).value.value,"onUpdate:modelValue":e[20]||(e[20]=a=>o(ze).value.value=a),"error-messages":o(ze).errorMessage.value,label:"*科威系統及員工編號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(ne).value.value,"onUpdate:modelValue":e[21]||(e[21]=a=>o(ne).value.value=a),"error-messages":o(ne).errorMessage.value,label:"Email",variant:"outlined",density:"compact",clearable:"","append-inner-icon":"mdi-at","onClick:appendInner":Zl},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(Oe).value.value,"onUpdate:modelValue":e[22]||(e[22]=a=>o(Oe).value.value=a),"error-messages":o(Oe).errorMessage.value,label:"Email密碼",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(Ee).value.value,"onUpdate:modelValue":e[23]||(e[23]=a=>o(Ee).value.value=a),"error-messages":o(Ee).errorMessage.value,label:"*分機號碼",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(W,{modelValue:o(_e).value.value,"onUpdate:modelValue":e[24]||(e[24]=a=>o(_e).value.value=a),"error-messages":o(_e).errorMessage.value,label:"*列印編號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(j,{modelValue:o(re).value.value,"onUpdate:modelValue":[e[25]||(e[25]=a=>o(re).value.value=a),Fl],"error-messages":o(re).errorMessage.value,items:de,label:"*任職狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),l(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),l(u,{cols:"6",sm:"2",class:"d-flex align-center justify-center"},{default:t(()=>[l(y,{size:"18",class:"me-2"},{default:t(()=>e[83]||(e[83]=[r(" mdi-calendar-outline ")])),_:1}),e[84]||(e[84]=r(" 日期資料 "))]),_:1}),l(u,{cols:"3",sm:"5",class:"d-flex align-center justify-center"},{default:t(()=>[l(le,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),l(u,{cols:"12",sm:"3"},{default:t(()=>[l(n,{modelValue:o(Ue).value.value,"onUpdate:modelValue":e[26]||(e[26]=a=>o(Ue).value.value=a),"error-messages":o(Ue).errorMessage.value,label:"*到職日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":e[27]||(e[27]=a=>o(Ue).value.value=null)},null,8,["modelValue","error-messages"])]),_:1}),o(Z).value.value?(c(),U(u,{key:1,cols:"12",sm:"3"},{default:t(()=>[l(n,{modelValue:o(Z).value.value,"onUpdate:modelValue":e[28]||(e[28]=a=>o(Z).value.value=a),"error-messages":o(Z).errorMessage.value,label:"留停開始日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":e[29]||(e[29]=a=>o(Z).value.value=null)},null,8,["modelValue","error-messages"])]),_:1})):S("",!0),o(G).value.value?(c(),U(u,{key:2,cols:"12",sm:"3"},{default:t(()=>[l(n,{modelValue:o(G).value.value,"onUpdate:modelValue":e[30]||(e[30]=a=>o(G).value.value=a),"error-messages":o(G).errorMessage.value,label:"留停復職日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":e[31]||(e[31]=a=>o(G).value.value=null)},null,8,["modelValue","error-messages"])]),_:1})):S("",!0),o(Q).value.value?(c(),U(u,{key:3,cols:"12",sm:"3"},{default:t(()=>[l(n,{modelValue:o(Q).value.value,"onUpdate:modelValue":e[32]||(e[32]=a=>o(Q).value.value=a),"error-messages":o(Q).errorMessage.value,label:"離職日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":e[33]||(e[33]=a=>o(Q).value.value=null)},null,8,["modelValue","error-messages"])]),_:1})):S("",!0),l(u,{cols:"12"},{default:t(()=>[l(W,{modelValue:o(qe).value.value,"onUpdate:modelValue":e[34]||(e[34]=a=>o(qe).value.value=a),"error-messages":o(qe).errorMessage.value,label:"備註",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),l(ae,{class:"px-3 mt-4"},{default:t(()=>[l(I),l(v,{color:"grey-darken-1",variant:"outlined",size:_.value,onClick:Te},{default:t(()=>e[85]||(e[85]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"teal-darken-1",variant:"outlined",type:"submit",class:"ms-2",size:_.value,loading:o(pl)},{default:t(()=>[r(k(M.value.id?"修改":"新增"),1)]),_:1},8,["size","loading"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1})]),_:1})]),_:1},8,["modelValue","width","no-click-animation"]),l(xa,{modelValue:se.value.open,"onUpdate:modelValue":e[36]||(e[36]=a=>se.value.open=a),title:"確認刪除員工",message:`確定要刪除員工「<span class='text-pink-lighten-1' style='font-weight: 800;'>${se.value.name}</span>」嗎？此操作無法復原。`,"expected-name":se.value.name,"input-label":"員工姓名",onConfirm:Ml},null,8,["modelValue","message","expected-name"]),l(te,{modelValue:N.value.open,"onUpdate:modelValue":e[38]||(e[38]=a=>N.value.open=a),persistent:"","max-width":"320"},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",Wa,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[86]||(e[86]=[r(" mdi-calendar-remove ")])),_:1}),e[88]||(e[88]=r(" 離職日期 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:fl},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[87]||(e[87]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(n,{modelValue:N.value.date,"onUpdate:modelValue":e[37]||(e[37]=a=>N.value.date=a),label:"離職日期",variant:"outlined",density:"compact","prepend-icon":"","ok-text":"確認","cancel-text":"取消","error-messages":N.value.error},null,8,["modelValue","error-messages"])]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:fl},{default:t(()=>e[89]||(e[89]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"red-lighten-1",variant:"outlined",size:_.value,onClick:Al},{default:t(()=>e[90]||(e[90]=[r(" 確認 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(te,{modelValue:O.value.open,"onUpdate:modelValue":e[40]||(e[40]=a=>O.value.open=a),persistent:"","max-width":"320"},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",Ha,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[91]||(e[91]=[r(" mdi-calendar-clock ")])),_:1}),e[93]||(e[93]=r(" 留停開始日期 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:gl},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[92]||(e[92]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(n,{modelValue:O.value.date,"onUpdate:modelValue":e[39]||(e[39]=a=>O.value.date=a),label:"留職停薪開始日期",variant:"outlined",density:"compact","prepend-icon":"","ok-text":"確認","cancel-text":"取消","error-messages":O.value.error},null,8,["modelValue","error-messages"])]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:gl},{default:t(()=>e[94]||(e[94]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"amber-darken-4",variant:"outlined",size:_.value,onClick:ql},{default:t(()=>e[95]||(e[95]=[r(" 確認 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(te,{modelValue:F.value.open,"onUpdate:modelValue":e[42]||(e[42]=a=>F.value.open=a),persistent:"","max-width":"320"},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",Ga,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[96]||(e[96]=[r(" mdi-calendar-check ")])),_:1}),e[98]||(e[98]=r(" 留停復職日期 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:yl},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[97]||(e[97]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(n,{modelValue:F.value.date,"onUpdate:modelValue":e[41]||(e[41]=a=>F.value.date=a),label:"留停復職日期",variant:"outlined",density:"compact","prepend-icon":"","ok-text":"確認","cancel-text":"取消","error-messages":F.value.error},null,8,["modelValue","error-messages"])]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:yl},{default:t(()=>e[99]||(e[99]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"teal-darken-1",variant:"outlined",size:_.value,onClick:Bl},{default:t(()=>e[100]||(e[100]=[r(" 確認 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(te,{modelValue:i.value.open,"onUpdate:modelValue":e[49]||(e[49]=a=>i.value.open=a),"max-width":"320",persistent:he.value,"no-click-animation":he.value},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",Ja,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[101]||(e[101]=[r(" mdi-file-export ")])),_:1}),e[103]||(e[103]=r(" 匯出員工資料 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:Ke},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[102]||(e[102]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12",class:"px-1 py-0 py-sm-2"},{default:t(()=>[l(_a,{modelValue:i.value.type,"onUpdate:modelValue":e[43]||(e[43]=a=>i.value.type=a),"hide-details":""},{default:t(()=>[l(Sl,{label:"所有員工資料",value:"all",color:"deep-orange-darken-2"}),l(Sl,{label:"單一公司資料",value:"company",color:"deep-orange-darken-2"})]),_:1},8,["modelValue"])]),_:1}),i.value.type==="company"?(c(),U(u,{key:0,cols:"12",class:"pb-0"},{default:t(()=>[l(j,{modelValue:i.value.company,"onUpdate:modelValue":[e[44]||(e[44]=a=>i.value.company=a),Gl],items:De.value,"item-title":a=>a?`${a.name} (${a.companyId})`:"","item-value":"_id",label:"公司",variant:"outlined",density:"compact","error-messages":i.value.companyError,clearable:""},null,8,["modelValue","items","item-title","error-messages"])]),_:1})):S("",!0),i.value.type==="company"?(c(),U(u,{key:1,cols:"12",class:"pb-0"},{default:t(()=>[l(j,{modelValue:i.value.departments,"onUpdate:modelValue":[e[45]||(e[45]=a=>i.value.departments=a),e[46]||(e[46]=()=>i.value.departmentError="")],items:i.value.departmentOptions,"item-title":a=>a?`${a.name} (${a.departmentId})`:"","item-value":"_id",label:"部門",variant:"outlined",density:"compact","error-messages":i.value.departmentError,clearable:"",multiple:"",disabled:!i.value.company},{selection:t(({item:a,index:d})=>[d===0?(c(),T("span",Ya,k(a.raw.name),1)):d===1?(c(),T("span",Qa,"...")):S("",!0)]),"prepend-item":t(()=>[l(Ye,{title:"全選",color:"deep-purple-darken-2","prepend-icon":"mdi-checkbox-multiple-marked",active:i.value.departments.length===i.value.departmentOptions.length,onClick:Jl},null,8,["active"]),l(le,{class:"mt-2"})]),_:1},8,["modelValue","items","item-title","error-messages","disabled"])]),_:1})):S("",!0),l(u,{cols:"12"},{default:t(()=>[l(j,{modelValue:i.value.employmentStatus,"onUpdate:modelValue":[e[47]||(e[47]=a=>i.value.employmentStatus=a),e[48]||(e[48]=()=>i.value.employmentStatusError="")],items:de,label:"任職狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact","error-messages":i.value.employmentStatusError,clearable:"",multiple:""},{selection:t(({item:a,index:d})=>[d===0?(c(),T("span",Za,k(a.raw.title),1)):d===1?(c(),T("span",Ka,"...")):S("",!0)]),"prepend-item":t(()=>[l(Ye,{title:"全選",color:"deep-orange-darken-2","prepend-icon":"mdi-checkbox-multiple-marked",active:i.value.employmentStatus.length===de.length,onClick:Yl},null,8,["active"]),l(le,{class:"mt-2"})]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:Ke},{default:t(()=>e[104]||(e[104]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"deep-orange-darken-2",variant:"outlined",size:_.value,loading:he.value,onClick:Ql},{default:t(()=>e[105]||(e[105]=[r(" 匯出 ")])),_:1},8,["size","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","persistent","no-click-animation"]),l(te,{modelValue:X.value.open,"onUpdate:modelValue":e[51]||(e[51]=a=>X.value.open=a),"max-width":"360",persistent:pe.value,"no-click-animation":pe.value},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",et,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[106]||(e[106]=[r(" mdi-file-import ")])),_:1}),e[108]||(e[108]=r(" 匯入員工資料 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:ll},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[107]||(e[107]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(E,null,{default:t(()=>[l(u,{cols:"12"},{default:t(()=>[l(Ua,{modelValue:X.value.file,"onUpdate:modelValue":e[50]||(e[50]=a=>X.value.file=a),label:"*選擇 Excel 檔案",variant:"outlined",density:"compact","error-messages":X.value.fileError,accept:".xlsx",clearable:"",onChange:ea},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:ll},{default:t(()=>e[109]||(e[109]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"light-blue-darken-2",variant:"outlined",size:_.value,loading:pe.value,onClick:la},{default:t(()=>e[110]||(e[110]=[r(" 匯入 ")])),_:1},8,["size","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","persistent","no-click-animation"]),l(te,{modelValue:C.value.open,"onUpdate:modelValue":e[56]||(e[56]=a=>C.value.open=a),"max-width":"360",persistent:""},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",lt,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[111]||(e[111]=[r(" mdi-account-plus ")])),_:1}),e[113]||(e[113]=r(" 複製為系統用戶 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:e[52]||(e[52]=a=>C.value.open=!1)},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[112]||(e[112]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-6 pb-3"},{default:t(()=>{var a,d,p;return[g("div",at,[e[114]||(e[114]=r(" 確定要將員工「")),g("span",tt,k((a=C.value.employee)==null?void 0:a.name),1),e[115]||(e[115]=r("」新增為系統用戶嗎？ "))]),g("div",st,[e[116]||(e[116]=r(" 系統將自動創建對應的用戶帳號，預設密碼為：")),g("span",ot,"ys"+k((d=C.value.employee)==null?void 0:d.extNumber)+k((p=C.value.employee)==null?void 0:p.printNumber),1)]),l(j,{modelValue:C.value.selectedRole,"onUpdate:modelValue":[e[53]||(e[53]=b=>C.value.selectedRole=b),e[54]||(e[54]=b=>C.value.roleError="")],items:el.value,label:"選擇權限",variant:"outlined",density:"compact","hide-details":"",class:"py-2","error-messages":C.value.roleError},null,8,["modelValue","items","error-messages"])]}),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",class:"me-1",size:_.value,onClick:e[55]||(e[55]=a=>C.value.open=!1)},{default:t(()=>e[117]||(e[117]=[r(" 取消 ")])),_:1},8,["size"]),l(v,{color:"teal-darken-1",variant:"outlined",size:_.value,onClick:ra},{default:t(()=>e[118]||(e[118]=[r(" 確認 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(te,{modelValue:J.value.open,"onUpdate:modelValue":e[57]||(e[57]=a=>J.value.open=a),"max-width":"600",persistent:""},{default:t(()=>[l(A,{class:"rounded-lg"},{default:t(()=>[g("div",nt,[l(y,{size:"20",color:"white",class:"me-2"},{default:t(()=>e[119]||(e[119]=[r(" mdi-file-check ")])),_:1}),e[121]||(e[121]=r(" 匯入結果 ")),l(I),l(v,{icon:"",color:"white",variant:"plain",class:"opacity-100",ripple:!1,size:"20",onClick:xl},{default:t(()=>[l(y,{size:"20"},{default:t(()=>e[120]||(e[120]=[r(" mdi-close ")])),_:1})]),_:1})]),l(q,{class:"px-6 pt-7 pb-0"},{default:t(()=>[l(E,null,{default:t(()=>[J.value.success.length>0?(c(),U(u,{key:0,cols:"12"},{default:t(()=>[g("div",rt," 成功匯入 "+k(J.value.success.length)+" 筆資料 ",1),l(zl,{density:"compact",class:"bg-teal-lighten-5 rounded-lg"},{default:t(()=>[(c(!0),T(sl,null,Dl(J.value.success,(a,d)=>(c(),U(Ye,{key:d,title:`${a.employeeCode} - ${a.name}`,subtitle:a.message},null,8,["title","subtitle"]))),128))]),_:1})]),_:1})):S("",!0),J.value.errors.length>0?(c(),U(u,{key:1,cols:"12"},{default:t(()=>[g("div",ut," 匯入失敗 "+k(J.value.errors.length)+" 筆資料 ",1),l(zl,{density:"compact",class:"bg-red-lighten-5 rounded-lg"},{default:t(()=>[(c(!0),T(sl,null,Dl(J.value.errors,(a,d)=>(c(),U(Ye,{key:d,title:`${a.employeeCode} - ${a.name}`,subtitle:a.message},null,8,["title","subtitle"]))),128))]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1}),l(ae,{class:"px-6 pb-5"},{default:t(()=>[l(I),l(v,{color:"grey",variant:"outlined",size:_.value,onClick:xl},{default:t(()=>e[122]||(e[122]=[r(" 關閉 ")])),_:1},8,["size"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Nt=ca(it,[["__scopeId","data-v-07aca953"]]);export{Nt as default};

import{_ as Ql}from"./jspdf-DacfHTdZ.js";import{f as Oe,r as g,w as vl,k as Yl,aV as w,Z as I,bH as t,b2 as Zl,a8 as a,a7 as c,u as n,a5 as ea,aG as ie,bf as b,a0 as p,bJ as Ge,$ as F,_ as L,aH as la,bM as aa,b0 as fl,F as gl}from"./@vue-Cr_z6yfx.js";import{l as yl}from"./lodash-CiJWSuVn.js";import{_ as ta,u as sa,b as oa}from"./index-ZcDhEpUM.js";import{i as na}from"./vuetify-use-dialog-C5oZ13xz.js";import{u as ua}from"./vue-router-CS4OewbW.js";import{C as ra}from"./ConfirmDeleteDialogWithTextField-DtpfDroW.js";import{b as ia,c as N,e as Je,g as bl}from"./yup-WHNMwcW8.js";import{u as da,a as _}from"./vee-validate-BXV9nMa7.js";import{q as ca,Q as pa,w as u,v as h,a as j,b as Se,c as O,P,_ as xl,K as ma,r as S,g as C,d as R,R as va,C as Ae,F as Ke,J as fa,U as ga,A as Y,e as Me,f as $e,V as ze,a3 as ya,a4 as kl,x as Qe,Y as ba,D as Vl,T as Ye}from"./vuetify-CbddcmEc.js";import"./core-js-D2hAHviU.js";import"./@babel-BsCcpEdk.js";import"./fflate-EnPhvkmS.js";import"./perfect-debounce-Cp2ysxOb.js";import"./hookable-B8xFkYCm.js";/* empty css             */import"./pinia-DBRIaiZ_.js";import"./vue-demi-Dq6ymT-8.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./unplugin-vue-router-B1N3mqWX.js";import"./axios-upsvKRUO.js";import"./vue3-google-login-Dx7TV_Hx.js";import"./vue-easy-lightbox-D952uME8.js";import"./property-expr-DEi1ZLzV.js";import"./tiny-case-BJ7jYKNY.js";import"./toposort-DzadwsAs.js";const xa={key:0},ka={class:"d-flex align-center ps-3 pe-4 py-2 bg-light-blue-darken-2 text-white"},Va={key:0},wa={class:"d-flex align-center px-3 py-2 bg-light-blue-darken-2 text-white"},ha={key:0,class:"status-cell d-flex align-center"},_a={class:"d-flex align-center px-3 py-2 bg-light-blue-darken-1 text-white"},Da={class:"d-flex align-center px-3 py-2 bg-light-blue-darken-3 text-white"},Sa={class:"d-flex align-center px-3 py-2 bg-teal-lighten-1 text-white"},Aa={class:"d-flex align-center px-3 py-2 bg-teal-darken-1 text-white"},Ca={key:0},Pa={class:"menu-header px-3 py-2"},Ea={class:"menu-card-text pa-4 pt-3"},Na={class:"text-center"},Ua={class:"d-flex align-center justify-center"},Ia={class:"card-title px-4 py-3"},Ta={key:0,class:"d-flex justify-center align-center",style:{"min-height":"458px"}},ja={key:0},Oa={key:1},Ma={class:"text-subtitle-1 font-weight-bold text-teal-lighten-1 mb-2"},$a={class:"text-subtitle-1 font-weight-bold text-red-lighten-1 mb-2"},za={__name:"hardwareDeviceManagement",setup(Fa){const{apiAuth:E}=oa(),x=na(),Ze=sa(),el=ua(),{smAndUp:Fe,mdAndUp:ll,xlAndUp:al}=ca(),tl=Oe(()=>Fe.value?"default":"small"),wl=Oe(()=>ll.value?"1200":"100%"),Ce=[{title:"硬體類型",key:"type.name",align:"start",sortable:!0},{title:"公司",key:"company.name",align:"start",sortable:!0},{title:"序號",key:"serialNumber",align:"start",sortable:!0},{title:"裝置名稱",key:"deviceName",align:"start",sortable:!0},{title:"登入名稱",key:"loginName",align:"start",sortable:!0},{title:"進貨日期",key:"purchaseDate",align:"start",sortable:!0},{title:"Office 2021 帳號",key:"office2021Account",align:"start",sortable:!0},{title:"Office 365 帳號",key:"office365Account",align:"start",sortable:!0},{title:"使用者",key:"user.name",width:"100px",align:"start",sortable:!0},{title:"庫存狀態",key:"stockStatus",align:"start",sortable:!0},{title:"報帳狀態",key:"expenseStatus",align:"start",sortable:!0},{title:"備註",key:"note",align:"start",sortable:!0},{title:"操作",key:"actions",align:"center",sortable:!1}],Pe=g(!1),sl=g([]),Ee=g(1),Ne=g(10),ol=g(0),de=g([{key:"type.name",order:"desc"}]),ce=g(""),H=g([]),Z=g([]),m=g({type:"",company:"",location:"",stockStatus:"",expenseStatus:"",dateType:"",dateRange:[],user:null}),nl=[{title:"未出貨",value:!0},{title:"已出貨",value:!1}],hl=[{title:"進貨日期",value:"purchaseDate"},{title:"安裝日期",value:"office2021InstallDate"},{title:"報帳日期",value:"expenseDate"}],ul=[{title:"已報帳",value:!0},{title:"未報帳",value:!1}],_l=Oe(()=>Fe.value?ll.value?al.value?Ce:Ce.filter(s=>s.key!=="note"):Ce.filter(s=>!["type.name","purchaseDate"].includes(s.key)):Ce.filter(s=>["deviceName","user.name","stockStatus","actions"].includes(s.key))),B=g({open:!1,id:"",name:"",type:"未知類型"}),D=g({open:!1,id:null}),ee=g(!1),M=g([]),Dl=Oe(()=>ia({type:N().required("請選擇硬體類型"),purchaseDate:Je().nullable(),deviceName:N().nullable(),loginName:N().nullable(),serialNumber:N().required("請輸入序號"),macAddress:N().nullable(),IPAddress:N().nullable(),user:N().nullable(),company:N().nullable(),stockStatus:bl().required("請選擇庫存狀態"),office2021Account:N().nullable(),office365Account:N().nullable(),office2021InstallDate:Je().nullable(),expenseStatus:bl().required("請選擇報帳狀態"),note:N().nullable(),location:N().nullable(),expenseObject:N().nullable(),expenseDate:Je().nullable()})),{handleSubmit:Sl,isSubmitting:Al,resetForm:rl}=da({validationSchema:Dl,initialValues:{type:"",purchaseDate:null,deviceName:"",loginName:"",serialNumber:"",macAddress:"",IPAddress:"",user:"",company:"",stockStatus:!0,office2021Account:"",office365Account:"",office2021InstallDate:null,expenseStatus:!1,note:"",location:"",expenseObject:"",expenseDate:null}}),pe=_("type"),le=_("purchaseDate"),me=_("deviceName"),ve=_("loginName"),q=_("serialNumber"),W=_("macAddress"),G=_("IPAddress"),J=_("user"),ae=_("company"),fe=_("stockStatus"),ge=_("office2021Account"),ye=_("office365Account"),te=_("office2021InstallDate"),be=_("expenseStatus"),xe=_("note"),se=_("location"),ke=_("expenseObject"),oe=_("expenseDate"),Le=g([]),Re=g(null),Ue=g([]),Cl=[{title:"裝置名稱",value:"deviceName"},{title:"進貨日期",value:"purchaseDate"},{title:"序號",value:"serialNumber"}],v=g({open:!1,type:"all",company:null,hardwareTypes:[],hardwareTypeError:"",companyError:"",sortBy:"deviceName"}),Pl=()=>{v.value={open:!0,type:"all",company:null,hardwareTypes:[],hardwareTypeError:"",companyError:"",sortBy:"deviceName"}},El=async()=>{var s,l;try{const{data:o}=await E.get("/hardware/categories/all",{params:{all:!0,type:0}});o.success&&(H.value=o.result.data.filter(e=>e.type===0))}catch(o){console.error("載入硬體類型列表失敗:",o),x({text:((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"載入硬體類型列表失敗",snackbarProps:{color:"red-lighten-1"}})}},Nl=async()=>{var s,l;try{const{data:o}=await E.get("/companies/all");o.success&&(Z.value=o.result.data)}catch(o){console.error("載入公司列表失敗:",o),x({text:((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"載入公司列表失敗",snackbarProps:{color:"red-lighten-1"}})}},Ul=()=>{m.value.dateRange=[]},Il=s=>{m.value.dateRange=s},Tl=async()=>{m.value={type:"",company:"",location:"",stockStatus:"",expenseStatus:"",dateType:"",dateRange:[],user:null},ce.value="",await he(),Ue.value=[],await z()},z=async()=>{var s,l,o,e,i;Pe.value=!0;try{const d={page:Ee.value,itemsPerPage:Ne.value,sortBy:((s=de.value[0])==null?void 0:s.key)||"purchaseDate",sortOrder:((l=de.value[0])==null?void 0:l.order)||"desc",search:ce.value,type:m.value.type,company:m.value.company,location:m.value.location,stockStatus:m.value.stockStatus,expenseStatus:m.value.expenseStatus,user:((o=m.value.user)==null?void 0:o._id)||""};if(m.value.dateType&&Array.isArray(m.value.dateRange)&&m.value.dateRange.length>0){const r=new Date(m.value.dateRange[0]),k=new Date(m.value.dateRange[m.value.dateRange.length-1]);r.setHours(0,0,0,0),k.setHours(23,59,59,999),d.dateType=m.value.dateType,d.dateStart=r.toISOString(),d.dateEnd=k.toISOString()}const{data:f}=await E.get("/hardware/devices/all",{params:d});f.success&&(sl.value=f.result.data,ol.value=f.result.totalItems)}catch(d){console.error("搜尋失敗:",d),x({text:((i=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:i.message)||"搜尋失敗",snackbarProps:{color:"red-lighten-1"}})}finally{Pe.value=!1}};vl(()=>m.value.user,s=>{if(s){const l=M.value.find(o=>o._id===s._id);l&&(Re.value=l)}else Re.value=null}),Yl(async()=>{await Promise.all([El(),Nl(),he(),z()])});const jl=s=>{var l;B.value={open:!0,id:s._id,name:s.serialNumber,type:((l=s.type)==null?void 0:l.name)||"未知類型"}},Ol=async()=>{var s,l;try{await E.delete(`/hardware/devices/${B.value.id}`),await z(),B.value.open=!1,x({text:"刪除設備成功",snackbarProps:{color:"teal-lighten-1"}})}catch(o){x({text:((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"刪除失敗",snackbarProps:{color:"red-lighten-1"}})}},Ve=g(!1),we=g(!1),ne=g(""),X=g([]),K=g([]),il=yl.debounce(async s=>{var o,e;if(!s){!!D.value.open?X.value=[...M.value]:K.value=[...M.value];return}const l=!!D.value.open;l?Ve.value=!0:we.value=!0;try{const{data:i}=await E.get("/employees/suggestions",{params:{search:s,all:!0,itemsPerPage:9999}});i.success&&(l?X.value=i.result:K.value=i.result)}catch(i){console.error("搜尋使用者失敗:",i),x({text:((e=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:e.message)||"搜尋使用者失敗",snackbarProps:{color:"red-lighten-1"}})}finally{Ve.value=!1,we.value=!1}},300),dl=()=>{ne.value="",J.value?J.value.value="":m.value&&(m.value.user=null),!!D.value.open?X.value=[...M.value]:K.value=[...M.value]},he=async()=>{var l,o;if(M.value.length>0){!!D.value.open?X.value=[...M.value]:K.value=[...M.value];return}const s=!!D.value.open;s?Ve.value=!0:we.value=!0;try{const{data:e}=await E.get("/employees/all",{params:{status:"在職",all:!0,itemsPerPage:9999}});e.success&&(M.value=e.result.data,s?X.value=[...e.result.data]:K.value=[...e.result.data])}catch(e){console.error("載入使用者列表失敗:",e),x({text:((o=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:o.message)||"載入使用者列表失敗",snackbarProps:{color:"red-lighten-1"}})}finally{Ve.value=!1,we.value=!1}},cl=async s=>{var l,o,e,i,d,f,r;D.value.open=!0,D.value.id=(s==null?void 0:s._id)||null,ee.value=!0;try{await he(),s?(pe.value.value=((l=s.type)==null?void 0:l._id)||"",le.value.value=s.purchaseDate?new Date(s.purchaseDate):null,me.value.value=s.deviceName||"",ve.value.value=s.loginName||"",q.value.value=s.serialNumber||"",W.value.value=s.macAddress||"",G.value.value=s.IPAddress||"",J.value.value=((o=s.user)==null?void 0:o._id)||"",ae.value.value=((e=s.company)==null?void 0:e._id)||"",(i=s.company)!=null&&i._id&&(await Be(s.company._id),s.location&&(se.value.value=s.location._id||s.location)),fe.value.value=s.stockStatus,ge.value.value=s.office2021Account||"",ye.value.value=s.office365Account||"",te.value.value=s.office2021InstallDate?new Date(s.office2021InstallDate):null,be.value.value=s.expenseStatus,xe.value.value=s.note||"",ke.value.value=((d=s.expenseObject)==null?void 0:d._id)||"",oe.value.value=s.expenseDate?new Date(s.expenseDate):null):rl()}catch(k){console.error("載入設備資料失敗:",k),x({text:((r=(f=k==null?void 0:k.response)==null?void 0:f.data)==null?void 0:r.message)||"載入設備資料失敗",snackbarProps:{color:"red-lighten-1"}}),Ie()}finally{ee.value=!1}},Ie=()=>{D.value.open=!1,D.value.id=null,ee.value=!1,Re.value=null,X.value=[...M.value],ne.value="",rl()},Ml=async s=>{var l,o,e,i,d;try{if(!s||!s._id){x({text:"無效的項目資料",snackbarProps:{color:"red-lighten-1"}});return}D.value={open:!0,id:null},ee.value=!0;const{data:f}=await E.get(`/hardware/devices/${s._id}`);if(!f.success||!f.result)throw new Error("獲取資料失敗");const r=f.result;pe.value.value=((l=r.type)==null?void 0:l._id)||"",le.value.value=r.purchaseDate?new Date(r.purchaseDate):null,me.value.value=r.deviceName||"",ve.value.value=r.loginName||"",q.value.value="",W.value.value=r.macAddress||"",G.value.value=r.IPAddress||"",J.value.value=((o=r.user)==null?void 0:o._id)||"",ae.value.value=((e=r.company)==null?void 0:e._id)||"",(i=r.company)!=null&&i._id&&(await Be(r.company._id),r.location&&(se.value.value=r.location._id||r.location)),fe.value.value=r.stockStatus??!0,ge.value.value=r.office2021Account||"",ye.value.value=r.office365Account||"",te.value.value=r.office2021InstallDate?new Date(r.office2021InstallDate):null,be.value.value=r.expenseStatus??!1,xe.value.value=r.note||"",ke.value.value=((d=r.expenseObject)==null?void 0:d._id)||"",oe.value.value=r.expenseDate?new Date(r.expenseDate):null,x({text:"請輸入新的序號",snackbarProps:{color:"warning",timeout:4e3}})}catch(f){console.error("複製項目發生錯誤:",f),Ll(f),D.value.open=!1}finally{ee.value=!1}},$l=Sl(async s=>{var l,o,e,i;try{const d={...s,type:s.type||null,user:s.user||null,company:s.company||null,location:s.location||null,expenseObject:s.expenseObject||null};if(d.expenseObject&&typeof d.expenseObject=="object"&&(d.expenseObject=d.expenseObject._id),D.value.id){const{data:f}=await E.patch(`/hardware/devices/${D.value.id}`,d);f.success&&(await z(),Ie(),x({text:"設備資料更新成功",snackbarProps:{color:"teal-lighten-1"}}))}else{const{data:f}=await E.post("/hardware/devices",d);f.success&&(await z(),Ie(),x({text:"新增設備成功",snackbarProps:{color:"teal-lighten-1"}}))}}catch(d){const f=(o=(l=d==null?void 0:d.response)==null?void 0:l.data)==null?void 0:o.message,r=(i=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:i.field;if(x({text:f||"操作失敗",snackbarProps:{color:"red-lighten-1"}}),r){const k=()=>f;switch(r){case"serialNumber":q.value.value=s.serialNumber,q.value.rules=[k];break;case"macAddress":W.value.value=s.macAddress,W.value.rules=[k];break;case"IPAddress":G.value.value=s.IPAddress,G.value.rules=[k];break}return}}}),Be=async s=>{var l,o;if(se.value.value="",Le.value=[],!!s)try{const{data:e}=await E.get(`/companies/${s}`);e.success&&(Le.value=e.result.locations||[])}catch(e){console.error("載入地點列表失敗:",e),x({text:((o=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:o.message)||"載入地點列表失敗",snackbarProps:{color:"red-lighten-1"}})}},zl=async s=>{var l,o;if(m.value.location="",Ue.value=[],!!s)try{const{data:e}=await E.get(`/companies/${s}`);e.success&&(Ue.value=e.result.locations||[])}catch(e){console.error("載入地點列表失敗:",e),x({text:((o=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:o.message)||"載入地點列表失敗",snackbarProps:{color:"red-lighten-1"}})}},Xe=g(!1),Fl=async()=>{var s,l,o,e;try{let i=!1;if(v.value.hardwareTypeError="",v.value.companyError="",(!v.value.hardwareTypes||v.value.hardwareTypes.length===0)&&(v.value.hardwareTypeError="請選擇至少一個硬體類型",i=!0),v.value.type==="company"&&!v.value.company&&(v.value.companyError="請選擇公司",i=!0),i)return;Xe.value=!0;const d={type:v.value.type,sortBy:v.value.sortBy};v.value.type==="company"&&(d.company=v.value.company),v.value.hardwareTypes.length>0&&(d.hardwareTypes=v.value.hardwareTypes.join(","));const{data:f}=await E.get("/hardware/devices/export",{params:d});if(f.success){const r=await Ql(()=>import("./xlsx-B6sNpj_1.js"),[],import.meta.url),k=f.result.map(y=>{var V,re,_e,De,A;return{硬體類型:((V=y.type)==null?void 0:V.name)||"",公司:((re=y.company)==null?void 0:re.name)||"",地點:((_e=y.location)==null?void 0:_e.locationName)||"",序號:y.serialNumber||"",進貨日期:ue(y.purchaseDate),使用者:((De=y.user)==null?void 0:De.name)||"",裝置名稱:y.deviceName||"",登入名稱:y.loginName||"","Office 2021 帳號":y.office2021Account||"","Office 2021 安裝日期":ue(y.office2021InstallDate),"Office 365 帳號":y.office365Account||"",MAC:y.macAddress||"",IP:y.IPAddress||"",庫存狀態:y.stockStatus?"未出貨":"已出貨",報帳日期:ue(y.expenseDate),報帳對象:((A=y.expenseObject)==null?void 0:A.name)||"",報帳狀態:y.expenseStatus?"已報帳":"未報帳",備註:y.note||""}}),Q=r.utils.json_to_sheet(k),He={硬體類型:15,公司:20,地點:15,序號:20,進貨日期:15,使用者:15,裝置名稱:20,登入名稱:20,"Office 2021 帳號":25,"Office 2021 安裝日期":25,"Office 365 帳號":25,MAC:20,IP:15,庫存狀態:12,報帳日期:15,報帳對象:20,報帳狀態:12,備註:30};Q["!cols"]=Object.values(He).map(y=>({wch:y}));const qe=r.utils.book_new();r.utils.book_append_sheet(qe,Q,"硬體設備資料");const We=v.value.type==="all"?"所有硬體設備資料清單.xlsx":`${(s=Z.value.find(y=>y._id===v.value.company))==null?void 0:s.name}硬體設備資料清單.xlsx`;r.writeFile(qe,We),pl(),x({text:"Excel 匯出成功",snackbarProps:{color:"teal-lighten-1"}})}}catch(i){console.error("Error:",i);const d=((o=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:o.message)||"操作失敗";((e=i==null?void 0:i.response)==null?void 0:e.status)===401?(Ze.logout(),el.push("/login"),x({text:"登入已過期，請重新登入",snackbarProps:{color:"red-lighten-1"}})):x({text:d,snackbarProps:{color:"red-lighten-1"}})}finally{Xe.value=!1}},ue=s=>s?new Date(s).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}):"",Ll=s=>{var o,e,i;console.error("Error:",s);const l=((e=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:e.message)||"操作失敗";((i=s==null?void 0:s.response)==null?void 0:i.status)===401?(Ze.logout(),el.push("/login"),x({text:"登入已過期，請重新登入",snackbarProps:{color:"red-lighten-1"}})):x({text:l,snackbarProps:{color:"red-lighten-1"}})},Rl=async s=>{var l;Ee.value=s.page,Ne.value=s.itemsPerPage,((l=s.sortBy)==null?void 0:l.length)>0&&(de.value=s.sortBy),await z()},Bl=yl.debounce(()=>{Ee.value=1,z()},300);vl(ce,()=>{Bl()});const Te=s=>s?`${s.name} (${s.employeeId||""})`:"",pl=()=>{v.value.open=!1},Xl=()=>{v.value.hardwareTypeError="",v.value.hardwareTypes.length===H.value.length?v.value.hardwareTypes=[]:v.value.hardwareTypes=H.value.map(s=>s._id)},je=g(!1),U=g({open:!1,file:null,fileError:""}),$=g({open:!1,success:[],errors:[]}),Hl=()=>{U.value={open:!0,file:null,fileError:""}},ml=()=>{U.value.open=!1},ql=()=>{$.value.open=!1},Wl=()=>{U.value.fileError=""},Gl=async()=>{var s,l;try{let o=!1;if(U.value.fileError="",U.value.file||(U.value.fileError="請選擇檔案",o=!0),o)return;je.value=!0;const e=await Jl(),i=new FileReader;i.onload=async d=>{var f,r;try{const k=new Uint8Array(d.target.result),Q=e.read(k,{type:"array",cellDates:!0,dateNF:"yyyy/mm/dd"}),He=Q.Sheets[Q.SheetNames[0]],We=e.utils.sheet_to_json(He).map(V=>{var De;const re=A=>{if(!A)return"";if(typeof A=="number"){const T=new Date(1899,11,30);return new Date(T.getTime()+A*24*60*60*1e3).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"/")}if(typeof A=="string"){const T=new Date(A);if(!isNaN(T.getTime()))return T.toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"/")}return A},_e=A=>{if(typeof A=="boolean")return A;if(typeof A=="string"){const T=A.toLowerCase();if(["未出貨"].includes(T))return!0;if(["已出貨"].includes(T))return!1;if(["已報帳"].includes(T))return!0;if(["未報帳"].includes(T))return!1;if(["true","是","1"].includes(T))return!0;if(["false","否","0"].includes(T))return!1}return typeof A=="number"?A===1:null};return{type:V.硬體類型,purchaseDate:re(V.進貨日期),deviceName:V.裝置名稱,loginName:V.登入名稱,office2021Account:V["Office 2021 帳號"],office2021InstallDate:re(V["Office 2021 安裝日期"]),office365Account:V["Office 365 帳號"],user:V.使用者,serialNumber:(De=V.序號)==null?void 0:De.toString(),macAddress:V.MAC,IPAddress:V.IP,company:V.公司,location:V.地點,expenseObject:V.報帳對象,expenseDate:re(V.報帳日期),expenseStatus:_e(V.報帳狀態),stockStatus:_e(V.庫存狀態),note:V.備註}}),{data:y}=await E.post("/hardware/devices/import",{devices:We});y.success&&($.value={open:!0,success:y.result.success,errors:y.result.errors},ml(),await z(),x({text:"匯入完成",snackbarProps:{color:"teal-lighten-1"}}))}catch(k){console.error("Error:",k);const Q=((r=(f=k==null?void 0:k.response)==null?void 0:f.data)==null?void 0:r.message)||"匯入失敗";x({text:Q,snackbarProps:{color:"red-lighten-1"}})}finally{je.value=!1}},i.readAsArrayBuffer(U.value.file)}catch(o){console.error("Error:",o);const e=((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"匯入失敗";x({text:e,snackbarProps:{color:"red-lighten-1"}}),je.value=!1}},Jl=async()=>(window.XLSX||await new Promise((s,l)=>{const o=document.createElement("script");o.src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js",o.onload=s,o.onerror=l,document.head.appendChild(o)}),window.XLSX),Kl=()=>{const s=document.createElement("a");s.href="https://eip.ystravel.com.tw/GInternational/uploads/example/example_deviceList.xlsx",s.download="example_deviceList.xlsx",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),x({text:"範例檔案下載成功",snackbarProps:{color:"teal-lighten-1"}})};return(s,l)=>{const o=Zl("v-date-input");return w(),I(pa,{"max-width":"2500"},{default:t(()=>[a(h,{class:"pt-md-5"},{default:t(()=>[a(u,{cols:"12",lg:"2"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",class:"mt-1 px-lg-5"},{default:t(()=>[a(j,{class:"elevation-4 rounded-lg py-6 px-4 px-sm-2 px-xl-4"},{default:t(()=>[a(Se,{class:"font-weight-bold d-flex align-center mb-2"},{default:t(()=>l[47]||(l[47]=[c(" 搜尋條件 ")])),_:1}),a(O,{class:"pa-2"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.type,"onUpdate:modelValue":l[0]||(l[0]=e=>m.value.type=e),items:H.value,"item-title":e=>e?e.name:"","item-value":"_id",label:"硬體類型",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items","item-title"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.company,"onUpdate:modelValue":[l[1]||(l[1]=e=>m.value.company=e),zl],items:Z.value,"item-title":e=>e?`${e.name} (${e.companyId})`:"","item-value":"_id",label:"公司",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items","item-title"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.location,"onUpdate:modelValue":l[2]||(l[2]=e=>m.value.location=e),items:Ue.value,"item-title":e=>e?e.locationName:"","item-value":"_id",label:"地點",variant:"outlined",density:"compact","hide-details":"",clearable:"",disabled:!m.value.company},null,8,["modelValue","items","item-title","disabled"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.stockStatus,"onUpdate:modelValue":l[3]||(l[3]=e=>m.value.stockStatus=e),items:nl,label:"庫存狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.expenseStatus,"onUpdate:modelValue":l[4]||(l[4]=e=>m.value.expenseStatus=e),items:ul,label:"報帳狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(xl,{modelValue:m.value.user,"onUpdate:modelValue":l[5]||(l[5]=e=>m.value.user=e),"search-input":ne.value,"onUpdate:searchInput":l[6]||(l[6]=e=>ne.value=e),items:K.value,loading:we.value,label:"使用者","return-object":"","item-props":e=>({key:e._id,title:Te(e),value:e._id}),variant:"outlined",density:"compact","hide-details":"",clearable:"","onUpdate:search":n(il),"onClick:clear":dl,"onClick:input":he},ea({selection:t(({item:e})=>[c(b(Te(K.value.find(i=>i._id===e.value))),1)]),_:2},[n(Fe)?{name:"append-inner",fn:t(()=>[a(ma,{location:"top","close-delay":"200"},{activator:t(({props:e})=>[a(S,ie(e,{icon:"mdi-information",size:"18"}),null,16)]),default:t(()=>[l[48]||(l[48]=c(" 輸入系統員工編號或姓名查詢 "))]),_:1})]),key:"0"}:void 0]),1032,["modelValue","search-input","items","loading","item-props","onUpdate:search"])]),_:1})]),_:1}),a(h,{class:"border rounded-lg border border-opacity-25 mb-2 mx-0"},{default:t(()=>[a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(P,{modelValue:m.value.dateType,"onUpdate:modelValue":[l[7]||(l[7]=e=>m.value.dateType=e),Ul],items:hl,label:"日期類型","item-title":"title","item-value":"value",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{cols:"12",sm:"6",lg:"12"},{default:t(()=>[a(o,{modelValue:m.value.dateRange,"onUpdate:modelValue":[l[8]||(l[8]=e=>m.value.dateRange=e),Il],label:"日期區間",variant:"outlined",density:"compact","prepend-icon":"","hide-details":"",clearable:"",multiple:"range",disabled:!m.value.dateType,"cancel-text":"取消","ok-text":"確認"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),a(h,null,{default:t(()=>[a(u,{cols:"12",class:"d-flex justify-end gap-2"},{default:t(()=>[a(h,{class:"d-flex justify-space-between"},{default:t(()=>[a(u,{cols:"3",class:"pe-0"},{default:t(()=>[a(C,{color:"grey",width:"40",block:"",onClick:Tl},{default:t(()=>[a(S,null,{default:t(()=>l[49]||(l[49]=[c("mdi-refresh")])),_:1})]),_:1})]),_:1}),a(u,{cols:"8",class:"ps-0"},{default:t(()=>[a(C,{color:"cyan-darken-2","prepend-icon":"mdi-magnify",loading:Pe.value,block:"",onClick:z},{default:t(()=>l[50]||(l[50]=[c(" 搜尋 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",class:"px-5"},{default:t(()=>[a(j,{class:"elevation-4 rounded-lg py-5 px-4 px-sm-2 px-xl-4"},{default:t(()=>[a(Se,{class:"font-weight-bold d-flex justify-space-between mb-2"},{default:t(()=>[l[52]||(l[52]=p("span",null,"匯入 / 匯出 Excel",-1)),Ge((w(),I(C,{icon:"",variant:"text",color:"blue-grey-darken-2",size:"28",onClick:Kl},{default:t(()=>[a(S,{size:"20"},{default:t(()=>l[51]||(l[51]=[c(" mdi-download-box-outline ")])),_:1})]),_:1})),[[Ye,"下載範例檔案","start"]])]),_:1}),a(O,{class:"pa-2"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"6"},{default:t(()=>[a(C,{"prepend-icon":"mdi-file-import",color:"light-blue-darken-2",block:"",class:"me-4",onClick:Hl},{default:t(()=>l[53]||(l[53]=[c(" 匯入 ")])),_:1})]),_:1}),a(u,{cols:"6"},{default:t(()=>[a(C,{"prepend-icon":"mdi-file-export",color:"deep-orange-darken-1",block:"",onClick:Pl},{default:t(()=>l[54]||(l[54]=[c(" 匯出 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",lg:"10",class:"px-6 ps-lg-4 pe-lg-8 mb-6"},{default:t(()=>[a(h,{class:"elevation-4 rounded-lg py-4 py-sm-8 px-1 px-sm-4 px-md-6 mt-1 bg-white"},{default:t(()=>[a(u,{cols:"12",class:"ps-4 pb-sm-4"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,null,{default:t(()=>l[55]||(l[55]=[p("h3",null," 硬體設備管理 ",-1)])),_:1}),a(u,{cols:"12",class:"d-flex align-center"},{default:t(()=>[a(h,{class:"d-flex justify-space-between"},{default:t(()=>[a(u,{cols:"4"},{default:t(()=>[a(C,{"prepend-icon":"mdi-laptop",variant:"outlined",color:"blue-grey-darken-1",class:"me-4",onClick:l[9]||(l[9]=e=>cl(null))},{default:t(()=>l[56]||(l[56]=[c(" 新增設備 ")])),_:1})]),_:1}),a(u,{cols:"3",xl:"2",class:"d-flex align-center"},{default:t(()=>[Ge(a(S,{icon:"mdi-information",size:"small",color:"blue-grey-darken-2",class:"me-2"},null,512),[[Ye,"可搜尋裝置名稱、登入名稱、序號、MAC、IP、Office 2021 帳號、Office 365 帳號、備註","start"]]),a(R,{modelValue:ce.value,"onUpdate:modelValue":l[10]||(l[10]=e=>ce.value=e),label:"快速搜尋","append-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12"},{default:t(()=>[a(va,{"items-per-page":Ne.value,"onUpdate:itemsPerPage":l[11]||(l[11]=e=>Ne.value=e),"sort-by":de.value,"onUpdate:sortBy":l[12]||(l[12]=e=>de.value=e),items:sl.value,headers:_l.value,loading:Pe.value,"items-length":ol.value,page:Ee.value,hover:"",density:"compact",class:"rounded-ts-lg rounded-te-lg","onUpdate:options":Rl},{item:t(({item:e,index:i})=>{var d,f;return[p("tr",{class:la({"odd-row":i%2===0,"even-row":i%2!==0})},[p("td",null,b((d=e.type)==null?void 0:d.name),1),p("td",null,[(f=e.company)!=null&&f.name?(w(),F("div",xa,[a(Ae,{location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:r})=>{var k;return[p("div",ie(r,{class:"d-flex align-center status-cell"}),b((k=e.company)==null?void 0:k.name),17)]}),default:t(()=>[a(j,{class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[a(O,{class:"pa-0"},{default:t(()=>{var r;return[p("div",ka,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[57]||(l[57]=[c(" mdi-map-marker ")])),_:1}),p("span",null,"地點："+b(((r=e.location)==null?void 0:r.locationName)||"無"),1)])]}),_:2},1024)]),_:2},1024)]),_:2},1024)])):L("",!0)]),p("td",null,b(e.serialNumber),1),p("td",null,b(e.deviceName),1),p("td",null,b(e.loginName),1),p("td",null,b(ue(e.purchaseDate)),1),p("td",null,[e.office2021Account?(w(),F("div",Va,[a(Ae,{location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:r})=>[p("div",ie(r,{class:"d-flex align-center status-cell"}),b(e.office2021Account),17)]),default:t(()=>[a(j,{"min-width":"200",class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[a(O,{class:"pa-0"},{default:t(()=>[p("div",wa,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[58]||(l[58]=[c(" mdi-calendar ")])),_:1}),p("span",null,"安裝日期："+b(ue(e.office2021InstallDate)||"無"),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)])):L("",!0)]),p("td",null,b(e.office365Account),1),p("td",null,[e.user?(w(),F("div",ha,[a(Ae,{location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:r})=>[p("div",ie(r,{class:"d-flex align-center status-cell pe-4"}),b(e.user.name),17)]),default:t(()=>[a(j,{"min-width":"130",class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[a(O,{class:"pa-0"},{default:t(()=>[p("div",_a,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[59]||(l[59]=[c(" mdi-phone ")])),_:1}),p("span",null,"分機號碼："+b(e.user.extNumber||"無"),1)]),p("div",Da,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[60]||(l[60]=[c(" mdi-printer ")])),_:1}),p("span",null,"列印編號："+b(e.user.printNumber||"無"),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)])):L("",!0)]),p("td",null,[a(Ke,{size:"small",variant:"outlined",color:e.stockStatus?"info":"grey"},{default:t(()=>[c(b(e.stockStatus?"未出貨":"已出貨"),1)]),_:2},1032,["color"])]),p("td",null,[e.expenseStatus?(w(),I(Ae,{key:0,location:"end",transition:"fade-transition","open-on-hover":"","close-delay":"30","open-delay":"30",class:"pa-0"},{activator:t(({props:r})=>[p("div",ie(r,{class:"d-flex align-center status-cell"}),[a(Ke,{size:"small",variant:"outlined",color:e.expenseStatus?"teal-lighten-1":"red-lighten-1"},{default:t(()=>[c(b(e.expenseStatus?"已報帳":"未報帳"),1)]),_:2},1032,["color"])],16)]),default:t(()=>[a(j,{"min-width":"200",class:"rounded-lg pa-0 status-card",elevation:"3"},{default:t(()=>[a(O,{class:"pa-0"},{default:t(()=>{var r;return[p("div",Sa,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[61]||(l[61]=[c(" mdi-office-building ")])),_:1}),p("span",null,"報帳對象："+b(((r=e.expenseObject)==null?void 0:r.name)||"無"),1)]),p("div",Aa,[a(S,{size:"16",class:"me-2",color:"white"},{default:t(()=>l[62]||(l[62]=[c(" mdi-calendar ")])),_:1}),p("span",null,"報帳日期："+b(ue(e.expenseDate)||"無"),1)])]}),_:2},1024)]),_:2},1024)]),_:2},1024)):(w(),I(Ke,{key:1,size:"small",variant:"outlined",color:"red-lighten-1"},{default:t(()=>l[63]||(l[63]=[c(" 未報帳 ")])),_:1}))]),n(al)?(w(),F("td",Ca,[e.note?(w(),I(Ae,{key:0,location:"top",transition:"fade-transition","close-on-content-click":!0,"close-on-back":!0},{activator:t(({props:r})=>[p("div",ie(r,{class:"note-cell"}),b(e.note),17)]),default:t(()=>[a(j,{"min-width":"300","max-width":"400",class:"rounded-lg menu-card",elevation:"3"},{default:t(()=>[a(O,{class:"pa-0"},{default:t(()=>[p("div",Pa,[a(S,{size:"16",color:"white",class:"me-2"},{default:t(()=>l[64]||(l[64]=[c(" mdi-text-box ")])),_:1}),l[65]||(l[65]=p("span",{class:"text-white text-subtitle-2"},"備註內容",-1))]),p("div",Ea,b(e.note),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):L("",!0)])):L("",!0),p("td",Na,[p("div",Ua,[a(C,{icon:"",class:"me-1",color:"light-blue-darken-4",variant:"plain",size:"24",ripple:!1,onClick:r=>cl(e)},{default:t(()=>[a(S,null,{default:t(()=>l[66]||(l[66]=[c("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),Ge((w(),I(C,{icon:"",class:"me-1",color:"teal-darken-2",variant:"plain",size:"24",ripple:!1,onClick:r=>Ml(e)},{default:t(()=>[a(S,null,{default:t(()=>l[67]||(l[67]=[c("mdi-content-copy")])),_:1})]),_:2},1032,["onClick"])),[[Ye,"複製"]]),a(C,{icon:"",color:"red-lighten-1",variant:"plain",size:"24",ripple:!1,onClick:r=>jl(e)},{default:t(()=>[a(S,null,{default:t(()=>l[68]||(l[68]=[c("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])],2)]}),_:1},8,["items-per-page","sort-by","items","headers","loading","items-length","page"])]),_:1})]),_:1})]),_:1})]),_:1}),a(ra,{modelValue:B.value.open,"onUpdate:modelValue":l[13]||(l[13]=e=>B.value.open=e),title:"確認刪除設備",message:`確定要刪除序號為「<span class='text-pink-lighten-1' style='font-weight: 800;'>${B.value.name}</span>」的「<span class='text-teal-darken-1' style='font-weight: 800;'>${B.value.type}</span>」嗎？此操作無法復原。`,"expected-name":B.value.name,"input-label":"序號",onConfirm:Ol},null,8,["modelValue","message","expected-name"]),a(ze,{modelValue:D.value.open,"onUpdate:modelValue":l[36]||(l[36]=e=>D.value.open=e),persistent:"",width:wl.value},{default:t(()=>[a(j,{class:"rounded-lg px-4 py-6"},{default:t(()=>[p("div",Ia,b(D.value.id?"編輯設備資料":"新增設備"),1),a(O,{class:"mt-3 pa-3"},{default:t(()=>[ee.value?(w(),F("div",Ta,[a(fa,{indeterminate:"",color:"deep-purple-darken-2",size:"64",width:"8"})])):(w(),I(ga,{key:1,onSubmit:aa(n($l),["prevent"])},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),a(u,{cols:"2",class:"d-flex align-center justify-center"},{default:t(()=>[a(S,{size:"18",class:"me-2"},{default:t(()=>l[69]||(l[69]=[c(" mdi-laptop ")])),_:1}),l[70]||(l[70]=c(" 基本資料 "))]),_:1}),a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(pe).value.value,"onUpdate:modelValue":l[14]||(l[14]=e=>n(pe).value.value=e),"error-messages":n(pe).errorMessage.value,items:H.value,"item-title":e=>e?e.name:"","item-value":"_id",label:"*硬體類型",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages","items","item-title"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(ae).value.value,"onUpdate:modelValue":[l[15]||(l[15]=e=>n(ae).value.value=e),Be],"error-messages":n(ae).errorMessage.value,items:Z.value,"item-title":e=>e?`${e.name} (${e.companyId})`:"","item-value":"_id",label:"公司",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages","items","item-title"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(se).value.value,"onUpdate:modelValue":l[16]||(l[16]=e=>n(se).value.value=e),"error-messages":n(se).errorMessage.value,items:Le.value,"item-title":e=>e?e.locationName:"","item-value":"_id",label:"地點",variant:"outlined",density:"compact",clearable:"",disabled:!n(ae).value.value},null,8,["modelValue","error-messages","items","item-title","disabled"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(xl,{modelValue:n(J).value.value,"onUpdate:modelValue":l[17]||(l[17]=e=>n(J).value.value=e),"search-input":ne.value,"onUpdate:searchInput":l[18]||(l[18]=e=>ne.value=e),"error-messages":n(J).errorMessage.value,items:X.value,loading:Ve.value,label:"使用者","item-value":"_id","item-props":e=>({key:e._id,title:Te(e),value:e._id}),variant:"outlined",density:"compact","hide-details":"",clearable:"","onUpdate:search":n(il),"onClick:clear":dl,"onClick:input":he},{selection:t(({item:e})=>[c(b(Te(X.value.find(i=>i._id===e.value))),1)]),_:1},8,["modelValue","search-input","error-messages","items","loading","item-props","onUpdate:search"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(q).value.value,"onUpdate:modelValue":l[19]||(l[19]=e=>n(q).value.value=e),"error-messages":n(q).errorMessage.value,label:"*序號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(me).value.value,"onUpdate:modelValue":l[20]||(l[20]=e=>n(me).value.value=e),"error-messages":n(me).errorMessage.value,label:"裝置名稱",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(ve).value.value,"onUpdate:modelValue":l[21]||(l[21]=e=>n(ve).value.value=e),"error-messages":n(ve).errorMessage.value,label:"登入名稱",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(W).value.value,"onUpdate:modelValue":l[22]||(l[22]=e=>n(W).value.value=e),"error-messages":n(W).errorMessage.value,label:"MAC",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(G).value.value,"onUpdate:modelValue":l[23]||(l[23]=e=>n(G).value.value=e),"error-messages":n(G).errorMessage.value,label:"IP",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(o,{modelValue:n(le).value.value,"onUpdate:modelValue":l[24]||(l[24]=e=>n(le).value.value=e),"error-messages":n(le).errorMessage.value,label:"進貨日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":l[25]||(l[25]=e=>n(le).value.value=null)},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(fe).value.value,"onUpdate:modelValue":l[26]||(l[26]=e=>n(fe).value.value=e),"error-messages":n(fe).errorMessage.value,items:nl,label:"*庫存狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),a(u,{cols:"2",class:"d-flex align-center justify-center"},{default:t(()=>[a(S,{size:"18",class:"me-2"},{default:t(()=>l[71]||(l[71]=[c(" mdi-microsoft-office ")])),_:1}),l[72]||(l[72]=c(" Office 資料 "))]),_:1}),a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(ge).value.value,"onUpdate:modelValue":l[27]||(l[27]=e=>n(ge).value.value=e),"error-messages":n(ge).errorMessage.value,label:"Office 2021 帳號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(o,{modelValue:n(te).value.value,"onUpdate:modelValue":l[28]||(l[28]=e=>n(te).value.value=e),"error-messages":n(te).errorMessage.value,label:"Office 2021 安裝日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":l[29]||(l[29]=e=>n(te).value.value=null)},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(R,{modelValue:n(ye).value.value,"onUpdate:modelValue":l[30]||(l[30]=e=>n(ye).value.value=e),"error-messages":n(ye).errorMessage.value,label:"Office 365 帳號",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",class:"sub-title text-blue-grey-darken-2 d-flex align-center justify-center"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1}),a(u,{cols:"2",class:"d-flex align-center justify-center"},{default:t(()=>[a(S,{size:"18",class:"me-2"},{default:t(()=>l[73]||(l[73]=[c(" mdi-cash ")])),_:1}),l[74]||(l[74]=c(" 報帳資料 "))]),_:1}),a(u,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[a(Y,{class:"border-opacity-25",color:"blue-grey-darken-2"})]),_:1})]),_:1})]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(be).value.value,"onUpdate:modelValue":l[31]||(l[31]=e=>n(be).value.value=e),"error-messages":n(be).errorMessage.value,items:ul,label:"*報帳狀態","item-title":"title","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(P,{modelValue:n(ke).value.value,"onUpdate:modelValue":l[32]||(l[32]=e=>n(ke).value.value=e),"error-messages":n(ke).errorMessage.value,items:Z.value,"item-title":e=>e?`${e.name} (${e.companyId})`:"","item-value":"_id",label:"報帳對象",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages","items","item-title"])]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(o,{modelValue:n(oe).value.value,"onUpdate:modelValue":l[33]||(l[33]=e=>n(oe).value.value=e),"error-messages":n(oe).errorMessage.value,label:"報帳日期",variant:"outlined",density:"compact",clearable:"","prepend-icon":"","ok-text":"確認","cancel-text":"取消","onClick:clear":l[34]||(l[34]=e=>n(oe).value.value=null)},null,8,["modelValue","error-messages"])]),_:1}),a(u,{cols:"12"},{default:t(()=>[a(R,{modelValue:n(xe).value.value,"onUpdate:modelValue":l[35]||(l[35]=e=>n(xe).value.value=e),"error-messages":n(xe).errorMessage.value,label:"備註",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),a(Me,{class:"px-3 mt-4"},{default:t(()=>[a($e),a(C,{color:"grey-darken-1",variant:"outlined",size:tl.value,onClick:Ie},{default:t(()=>l[75]||(l[75]=[c(" 取消 ")])),_:1},8,["size"]),a(C,{color:"teal-darken-1",variant:"outlined",type:"submit",class:"ms-2",size:tl.value,loading:n(Al)},{default:t(()=>[c(b(D.value.id?"修改":"新增"),1)]),_:1},8,["size","loading"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),a(ze,{modelValue:v.value.open,"onUpdate:modelValue":l[43]||(l[43]=e=>v.value.open=e),"max-width":"320"},{default:t(()=>[a(j,{class:"rounded-lg px-4 pt-5 pb-4"},{default:t(()=>[a(Se,{class:"card-title mb-2"},{default:t(()=>l[76]||(l[76]=[c(" 匯出硬體設備資料 ")])),_:1}),a(O,{class:"pa-4"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",class:"px-1"},{default:t(()=>[a(ya,{modelValue:v.value.type,"onUpdate:modelValue":l[37]||(l[37]=e=>v.value.type=e),"hide-details":""},{default:t(()=>[a(kl,{label:"所有公司資料",value:"all",color:"deep-purple-darken-2"}),a(kl,{label:"單一公司資料",value:"company",color:"deep-purple-darken-2"})]),_:1},8,["modelValue"])]),_:1}),v.value.type==="company"?(w(),I(u,{key:0,cols:"12",class:"pb-0"},{default:t(()=>[a(P,{modelValue:v.value.company,"onUpdate:modelValue":[l[38]||(l[38]=e=>v.value.company=e),l[39]||(l[39]=()=>v.value.companyError="")],items:Z.value,"item-title":e=>e?`${e.name} (${e.companyId})`:"","item-value":"_id",label:"公司",variant:"outlined",density:"compact","error-messages":v.value.companyError,clearable:""},null,8,["modelValue","items","item-title","error-messages"])]),_:1})):L("",!0),a(u,{cols:"12"},{default:t(()=>[a(P,{modelValue:v.value.hardwareTypes,"onUpdate:modelValue":[l[40]||(l[40]=e=>v.value.hardwareTypes=e),l[41]||(l[41]=()=>v.value.hardwareTypeError="")],items:H.value,"item-title":e=>e?e.name:"","item-value":"_id",label:"硬體類型",variant:"outlined",density:"compact","error-messages":v.value.hardwareTypeError,clearable:"",multiple:""},{selection:t(({item:e,index:i})=>[i===0?(w(),F("span",ja,b(e.raw.name),1)):i===1?(w(),F("span",Oa,"...")):L("",!0)]),"prepend-item":t(()=>[a(Qe,{title:"全選",color:"deep-purple-darken-2","prepend-icon":"mdi-checkbox-multiple-marked",active:v.value.hardwareTypes.length===H.value.length,onClick:Xl},null,8,["active"]),a(Y,{class:"mt-2"})]),_:1},8,["modelValue","items","item-title","error-messages"])]),_:1}),a(u,{cols:"12"},{default:t(()=>[a(P,{modelValue:v.value.sortBy,"onUpdate:modelValue":l[42]||(l[42]=e=>v.value.sortBy=e),items:Cl,label:"次要排序方式","item-title":"title","item-value":"value",variant:"outlined",density:"compact","persistent-hint":"",hint:"會先依硬體類型排序，再依此選項排序"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(Me,{class:"pa-4"},{default:t(()=>[a($e),a(C,{color:"grey",variant:"outlined",onClick:pl},{default:t(()=>l[77]||(l[77]=[c(" 取消 ")])),_:1}),a(C,{color:"teal-darken-1",variant:"outlined",loading:Xe.value,class:"ms-2",onClick:Fl},{default:t(()=>l[78]||(l[78]=[c(" 匯出 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ze,{modelValue:U.value.open,"onUpdate:modelValue":l[45]||(l[45]=e=>U.value.open=e),"max-width":"380"},{default:t(()=>[a(j,{class:"rounded-lg px-4 pt-5 pb-4"},{default:t(()=>[a(Se,{class:"card-title mb-2"},{default:t(()=>l[79]||(l[79]=[c(" 匯入硬體設備資料 ")])),_:1}),a(O,{class:"pa-4"},{default:t(()=>[a(h,null,{default:t(()=>[a(u,{cols:"12",class:"pb-0"},{default:t(()=>[a(ba,{modelValue:U.value.file,"onUpdate:modelValue":l[44]||(l[44]=e=>U.value.file=e),label:"*選擇 Excel 檔案",variant:"outlined",density:"compact","error-messages":U.value.fileError,accept:".xlsx",clearable:"",onChange:Wl},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),a(Me,{class:"pa-4"},{default:t(()=>[a($e),a(C,{color:"grey",variant:"outlined",onClick:ml},{default:t(()=>l[80]||(l[80]=[c(" 取消 ")])),_:1}),a(C,{color:"teal-darken-1",variant:"outlined",loading:je.value,class:"ms-2",onClick:Gl},{default:t(()=>l[81]||(l[81]=[c(" 匯入 ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ze,{modelValue:$.value.open,"onUpdate:modelValue":l[46]||(l[46]=e=>$.value.open=e),"max-width":"600"},{default:t(()=>[a(j,{class:"rounded-lg px-4 pt-5 pb-4"},{default:t(()=>[a(Se,{class:"card-title"},{default:t(()=>l[82]||(l[82]=[c(" 匯入結果 ")])),_:1}),a(O,{class:"pa-4"},{default:t(()=>[a(h,null,{default:t(()=>[$.value.success.length>0?(w(),I(u,{key:0,cols:"12"},{default:t(()=>[p("div",Ma," 成功匯入 "+b($.value.success.length)+" 筆資料 ",1),a(Vl,{density:"compact",class:"bg-teal-lighten-5 rounded-lg"},{default:t(()=>[(w(!0),F(gl,null,fl($.value.success,(e,i)=>(w(),I(Qe,{key:i,title:`${e.serialNumber} - ${e.type}`,subtitle:e.message},null,8,["title","subtitle"]))),128))]),_:1})]),_:1})):L("",!0),$.value.errors.length>0?(w(),I(u,{key:1,cols:"12"},{default:t(()=>[p("div",$a," 匯入失敗 "+b($.value.errors.length)+" 筆資料 ",1),a(Vl,{density:"compact",class:"bg-red-lighten-5 rounded-lg"},{default:t(()=>[(w(!0),F(gl,null,fl($.value.errors,(e,i)=>(w(),I(Qe,{key:i,title:`${e.serialNumber} - ${e.type}`,subtitle:e.message},null,8,["title","subtitle"]))),128))]),_:1})]),_:1})):L("",!0)]),_:1})]),_:1}),a(Me,{class:"pa-4"},{default:t(()=>[a($e),a(C,{color:"grey",variant:"outlined",onClick:ql},{default:t(()=>l[83]||(l[83]=[c(" 關閉 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},vt=ta(za,[["__scopeId","data-v-2ff797b9"]]);export{vt as default};
